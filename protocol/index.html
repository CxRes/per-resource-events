<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <title>Per Resource Events Protocol</title>
  <meta content="w3c/ED" name="w3c-status">
  <link href="https://www.w3.org/StyleSheets/TR/2021/W3C-ED" rel="stylesheet">
  <meta content="Bikeshed version 82ce88815, updated Thu Sep 7 16:33:55 2023 -0700" name="generator">
  <link href="https://cxres.github.io/per-resource-events/protocol" rel="canonical">
  <link href="https://www.w3.org/2008/site/images/star.png" rel="icon">
  <meta content="4370e104e7cd47e939ea1a5427bfa6f0be395d6c" name="document-revision">
<style>
  body {
    background-image: none;
  }

  .v-space {
    padding: 4px;
  }

  .example > span.marker {
    text-transform: none;
  }

  prep-http-tabs pre.include-code {
    margin: 0;
    padding: 0.5em 1em 0.25em;
  }
</style>
  <link href="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.1.0/dist/themes/light.css" rel="stylesheet">
<style>/* Boilerplate: style-autolinks */
.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}

@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}
</style>
<style>/* Boilerplate: style-colors */

/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}
</style>
<style>/* Boilerplate: style-counters */
body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}
</style>
<style>/* Boilerplate: style-dfn-panel */
:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
}
@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
    }
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0 0 0 1em; list-style: none; }
.dfn-panel li a {
    white-space: pre;
    display: inline-block;
    max-width: calc(300px - 1.5em - 1em);
    overflow: hidden;
    text-overflow: ellipsis;
}

.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: .5em;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
}

.dfn-paneled[role="button"] { cursor: pointer; }
</style>
<style>/* Boilerplate: style-issues */
a[href].issue-return {
    float: right;
    float: inline-end;
    color: var(--issueheading-text);
    font-weight: bold;
    text-decoration: none;
}
</style>
<style>/* Boilerplate: style-md-lists */
/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}
</style>
<style>/* Boilerplate: style-selflinks */

:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
.example > a.self-link,
.note > a.self-link,
.issue > a.self-link {
    /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
    left: auto;
    right: 0;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* Boilerplate: style-syntax-highlighting */

code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }

.highlight:not(.idl) { background: rgba(0, 0, 0, .03); }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */


@media (prefers-color-scheme: dark) {
    .highlight:not(.idl) { background: rgba(255, 255, 255, .05); }

    c-[a] { color: #d33682 } /* Keyword.Declaration */
    c-[b] { color: #d33682 } /* Keyword.Type */
    c-[c] { color: #2aa198 } /* Comment */
    c-[d] { color: #2aa198 } /* Comment.Multiline */
    c-[e] { color: #268bd2 } /* Name.Attribute */
    c-[f] { color: #b58900 } /* Name.Tag */
    c-[g] { color: #cb4b16 } /* Name.Variable */
    c-[k] { color: #d33682 } /* Keyword */
    c-[l] { color: #657b83 } /* Literal */
    c-[m] { color: #657b83 } /* Literal.Number */
    c-[n] { color: #268bd2 } /* Name */
    c-[o] { color: #657b83 } /* Operator */
    c-[p] { color: #657b83 } /* Punctuation */
    c-[s] { color: #6c71c4 } /* Literal.String */
    c-[t] { color: #6c71c4 } /* Literal.String.Single */
    c-[u] { color: #6c71c4 } /* Literal.String.Double */
    c-[ch] { color: #2aa198 } /* Comment.Hashbang */
    c-[cp] { color: #2aa198 } /* Comment.Preproc */
    c-[cpf] { color: #2aa198 } /* Comment.PreprocFile */
    c-[c1] { color: #2aa198 } /* Comment.Single */
    c-[cs] { color: #2aa198 } /* Comment.Special */
    c-[kc] { color: #d33682 } /* Keyword.Constant */
    c-[kn] { color: #d33682 } /* Keyword.Namespace */
    c-[kp] { color: #d33682 } /* Keyword.Pseudo */
    c-[kr] { color: #d33682 } /* Keyword.Reserved */
    c-[ld] { color: #657b83 } /* Literal.Date */
    c-[nc] { color: #268bd2 } /* Name.Class */
    c-[no] { color: #268bd2 } /* Name.Constant */
    c-[nd] { color: #268bd2 } /* Name.Decorator */
    c-[ni] { color: #268bd2 } /* Name.Entity */
    c-[ne] { color: #268bd2 } /* Name.Exception */
    c-[nf] { color: #268bd2 } /* Name.Function */
    c-[nl] { color: #268bd2 } /* Name.Label */
    c-[nn] { color: #268bd2 } /* Name.Namespace */
    c-[py] { color: #268bd2 } /* Name.Property */
    c-[ow] { color: #657b83 } /* Operator.Word */
    c-[mb] { color: #657b83 } /* Literal.Number.Bin */
    c-[mf] { color: #657b83 } /* Literal.Number.Float */
    c-[mh] { color: #657b83 } /* Literal.Number.Hex */
    c-[mi] { color: #657b83 } /* Literal.Number.Integer */
    c-[mo] { color: #657b83 } /* Literal.Number.Oct */
    c-[sa] { color: #6c71c4 } /* Literal.String.Affix */
    c-[sb] { color: #6c71c4 } /* Literal.String.Backtick */
    c-[sc] { color: #6c71c4 } /* Literal.String.Char */
    c-[dl] { color: #6c71c4 } /* Literal.String.Delimiter */
    c-[sd] { color: #6c71c4 } /* Literal.String.Doc */
    c-[se] { color: #6c71c4 } /* Literal.String.Escape */
    c-[sh] { color: #6c71c4 } /* Literal.String.Heredoc */
    c-[si] { color: #6c71c4 } /* Literal.String.Interpol */
    c-[sx] { color: #6c71c4 } /* Literal.String.Other */
    c-[sr] { color: #6c71c4 } /* Literal.String.Regex */
    c-[ss] { color: #6c71c4 } /* Literal.String.Symbol */
    c-[fm] { color: #268bd2 } /* Name.Function.Magic */
    c-[vc] { color: #cb4b16 } /* Name.Variable.Class */
    c-[vg] { color: #cb4b16 } /* Name.Variable.Global */
    c-[vi] { color: #cb4b16 } /* Name.Variable.Instance */
    c-[vm] { color: #cb4b16 } /* Name.Variable.Magic */
    c-[il] { color: #657b83 } /* Literal.Number.Integer.Long */
}
</style>
 <body class="h-entry">
  <div class="head">
   <h1 class="p-name no-ref" id="title">Per Resource Events Protocol</h1>
   <p id="w3c-state"><a href="https://www.w3.org/standards/types#ED">Editor’s Draft</a>, <time class="dt-updated" datetime="2023-10-05">5 October 2023</time></p>
   <details open>
    <summary>More details about this document</summary>
    <div data-fill-with="spec-metadata">
     <dl>
      <dt>This version:
      <dd><a class="u-url" href="https://cxres.github.io/per-resource-events/protocol">https://cxres.github.io/per-resource-events/protocol</a>
      <dt>Issue Tracking:
      <dd><a href="https://github.com/cxres/per-resource-events/issues/">GitHub</a>
      <dt class="editor">Editor:
      <dd class="editor p-author h-card vcard"><a class="p-name fn u-url url" href="https://cxres.pages.dev/profile/#i">Rahul Gupta</a>
      <dt>Author:
      <dd><a href="https://cxres.pages.dev/profile/#i">Rahul Gupta</a>
     </dl>
    </div>
   </details>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright">Copyright © 2023, Per Resource Protocol Contributors </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>Per Resource Events is a minimal protocol built on top of HTTP that allows clients to receive notifications directly from any resource of interest in a secure manner.</p>
   <p>The Per Resource Events Protocol is predicated on the idea that the most intuitive source for notifications about changes made to a resource is the resource itself.</p>
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="sotd"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p></p>
   <p>This section describes the status of this document at the time of its publication.</p>
   <p>The information in this document is still subject to change. You are invited to contribute any feedback, comments, or questions you might have.</p>
   <p>This is a draft document and may be updated, replaced or obsoleted by other documents at any time. It is inappropriate to cite this document as other than work in progress.</p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li>
     <a href="#conformance"><span class="secno"></span> <span class="content"> Conformance </span></a>
     <ol class="toc">
      <li><a href="#document-conventions"><span class="secno"></span> <span class="content">Document Conventions</span></a>
      <li><a href="#conformant-algorithms"><span class="secno"></span> <span class="content">Conformant Algorithms</span></a>
      <li><a href="#compliance-with-other-specifications"><span class="secno"></span> <span class="content">Compliance with Other Specifications</span></a>
      <li><a href="#specification-category"><span class="secno"></span> <span class="content">Specification Category</span></a>
      <li><a href="#classes-of-products"><span class="secno"></span> <span class="content">Classes of Products</span></a>
      <li><a href="#interoperability"><span class="secno"></span> <span class="content">Interoperability</span></a>
     </ol>
    <li>
     <a href="#introduction"><span class="secno">1</span> <span class="content">Introduction</span></a>
     <ol class="toc">
      <li><a href="#motivation"><span class="secno">1.1</span> <span class="content">Motivation</span></a>
      <li><a href="#how-it-works"><span class="secno">1.2</span> <span class="content">How it Works</span></a>
      <li><a href="#scope"><span class="secno">1.3</span> <span class="content">Scope</span></a>
      <li><a href="#intended-audience"><span class="secno">1.4</span> <span class="content">Audience</span></a>
     </ol>
    <li>
     <a href="#design"><span class="secno">2</span> <span class="content">Design</span></a>
     <ol class="toc">
      <li><a href="#principles"><span class="secno">2.1</span> <span class="content">Principles</span></a>
      <li><a href="#goals"><span class="secno">2.2</span> <span class="content">Goals</span></a>
      <li><a href="#constraints"><span class="secno">2.3</span> <span class="content">Constraints</span></a>
      <li><a href="#known-limitations"><span class="secno">2.4</span> <span class="content">Known Limitations</span></a>
     </ol>
    <li><a href="#terminology"><span class="secno">3</span> <span class="content">Terminology</span></a>
    <li>
     <a href="#header-fields"><span class="secno">4</span> <span class="content">Header Fields</span></a>
     <ol class="toc">
      <li><a href="#accept-events-header"><span class="secno">4.1</span> <span class="content"> Accept-Events </span></a>
      <li><a href="#events-header"><span class="secno">4.2</span> <span class="content"> Events </span></a>
     </ol>
    <li>
     <a href="#protocol"><span class="secno">5</span> <span class="content">Protocol</span></a>
     <ol class="toc">
      <li><a href="#event-fields"><span class="secno">5.1</span> <span class="content">Event Fields</span></a>
      <li><a href="#methods"><span class="secno">5.2</span> <span class="content">Methods</span></a>
      <li><a href="#status-codes"><span class="secno">5.3</span> <span class="content">Status Codes</span></a>
     </ol>
    <li>
     <a href="#notifications-discovery"><span class="secno">6</span> <span class="content">Discovery</span></a>
     <ol class="toc">
      <li><a href="#discovery-request"><span class="secno">6.1</span> <span class="content">Request</span></a>
      <li><a href="#discovery-response-when-notifications-not-available"><span class="secno">6.2</span> <span class="content">Not Available</span></a>
      <li><a href="#discovery-response-when-notifications-available"><span class="secno">6.3</span> <span class="content">Available</span></a>
     </ol>
    <li><a href="#request"><span class="secno">7</span> <span class="content">Request</span></a>
    <li>
     <a href="#response-without-notifications"><span class="secno">8</span> <span class="content">Response without Notifications</span></a>
     <ol class="toc">
      <li><a href="#response-when-notifications-not-available"><span class="secno">8.1</span> <span class="content">Not Available</span></a>
      <li><a href="#error-response"><span class="secno">8.2</span> <span class="content">Error Response</span></a>
      <li><a href="#response-with-notification-errors"><span class="secno">8.3</span> <span class="content">Notification Errors</span></a>
     </ol>
    <li>
     <a href="#notifications-response"><span class="secno">9</span> <span class="content">Notifications Response</span></a>
     <ol class="toc">
      <li><a href="#notifications-response-common-headers"><span class="secno">9.1</span> <span class="content">Common Headers</span></a>
      <li><a href="#only-notifications-response"><span class="secno">9.2</span> <span class="content">Only Notifications</span></a>
      <li><a href="#composite-response"><span class="secno">9.3</span> <span class="content">Composite Response</span></a>
      <li><a href="#notifications-response-termination"><span class="secno">9.4</span> <span class="content">Termination</span></a>
     </ol>
    <li>
     <a href="#rfc822-for-notifications"><span class="secno"></span> <span class="content"> Appendix A: Additional Semantics for `message/rfc822` </span></a>
     <ol class="toc">
      <li><a href="#rfc822-request"><span class="secno"></span> <span class="content">Request</span></a>
      <li><a href="#rfc822-generation"><span class="secno"></span> <span class="content">Generation</span></a>
      <li><a href="#rfc822-headers"><span class="secno"></span> <span class="content">Headers</span></a>
      <li><a href="#rfc822-body"><span class="secno"></span> <span class="content">Body</span></a>
     </ol>
    <li>
     <a href="#considerations"><span class="secno"></span> <span class="content"> Considerations </span></a>
     <ol class="toc">
      <li><a href="#security-considerations"><span class="secno"></span> <span class="content">Security Considerations</span></a>
      <li><a href="#privacy-considerations"><span class="secno"></span> <span class="content">Privacy Considerations</span></a>
      <li><a href="#security-and-privacy-review"><span class="secno"></span> <span class="content">Security and Privacy Review</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
   </ol>
  </nav>
  <main>
   <h2 class="no-num heading settled" id="conformance"><span class="content"> Conformance </span></h2>
   <h3 class="heading settled" id="document-conventions"><span class="content">Document Conventions</span></h3>
   <p>All of the text of this specification is normative except assertions, diagrams, examples, notes and sections explicitly marked as non-normative as described in <a data-link-type="biblio" href="#biblio-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</a>.</p>
   <p>The key words "MUST", "MUST NOT", "SHOULD", "SHOULD NOT" and "MAY" in this document are to be interpreted as described in <a href="https://tools.ietf.org/html/bcp14">BCP 14</a> <a data-link-type="biblio" href="#biblio-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</a> <a data-link-type="biblio" href="#biblio-rfc8174" title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">[RFC8174]</a> when, and only when, they
appear in all capitals, as shown here.</p>
   <p>The above-mentioned key words are used exclusively in the normative parts of this document and appear only in all capitals.</p>
   <h3 class="heading settled" id="conformant-algorithms"><span class="content">Conformant Algorithms</span></h3>
   <p>Requirements phrased in the imperative as part of algorithms (such as "strip any leading space characters" or "return false and abort these steps") are to be interpreted with the meaning of the key word ("MUST", "SHOULD", "MAY", etc) used in introducing the algorithm.</p>
   <p>Conformance requirements phrased as algorithms or specific steps can be implemented in any manner, so long as the end result is equivalent. In particular, the algorithms defined in this specification are intended to be easy to understand and are not intended to be performant. Implementers are encouraged to optimize.</p>
   <h3 class="heading settled" id="compliance-with-other-specifications"><span class="content">Compliance with Other Specifications</span></h3>
   <p>In general, specifications interact with and rely on a wide variety of other specifications. In certain circumstances, unfortunately, conflicting needs require a specification to violate the requirements of other specifications. This specification denotes such transgressions as a <strong>wilful violation</strong> and records the reason for that violation. Other specifications that rely on this specification SHOULD do the same.</p>
   <h3 class="heading settled" id="specification-category"><span class="content">Specification Category</span></h3>
   <p>The <span class="title">Per Resource Events Protocol</span> identifies the following <a href="https://www.w3.org/TR/spec-variability/#spec-cat">Specification Category</a> to distinguish the types of conformance:</p>
   <ul>
    <li data-md>
     <p>API,</p>
    <li data-md>
     <p>Notation/syntax,</p>
    <li data-md>
     <p>Set of events,</p>
    <li data-md>
     <p>Protocol.</p>
   </ul>
   <h3 class="heading settled" id="classes-of-products"><span class="content">Classes of Products</span></h3>
   <p>The <span class="title">Per Resource Events Protocol</span> identifies the following Classes of Products for conforming implementations. These products are referenced throughout this specification.</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="resource-server">Resource Server</dfn>
    <dd data-md>
     <p>A <em>resource server</em> that builds on HTTP origin server (<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-3.6">§ 3.6 Origin Server</a>) by defining header fields (<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-6.3">§ 6.3 Header Fields</a>) and media types (<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-8.3.1">§ 8.3.1 Media Types</a>).</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="application-client">Application Client</dfn>
    <dd data-md>
     <p>An <em>application client</em> that builds on HTTP user Aagent (<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-3.5">§ 3.5 User Agents</a>) by defining behaviour in terms of fetching <a data-link-type="biblio" href="#biblio-fetch" title="Fetch Standard">[FETCH]</a> across the platform.</p>
   </dl>
   <h3 class="heading settled" id="interoperability"><span class="content">Interoperability</span></h3>
   <p>Interoperability occurs between <a href="#application-client—resource-server-interoperability" id="ref-for-application-client—resource-server-interoperability">Application Client—Resource Server</a> as defined by the <span class="title">Per Resource Events Protocol</span>.</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="application-client—resource-server-interoperability">Application Client—Resource Server Interoperability</dfn>
    <dd data-md>
     <p>Interoperability of implementations for <a data-link-type="dfn" href="#application-client" id="ref-for-application-client">application clients</a> and <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server">resource servers</a> is tested by evaluating an implementation’s ability to request and respond to HTTP messages that conform to the <span class="title">Per Resource Events Protocol</span>.</p>
   </dl>
   <h2 class="heading settled" data-level="1" id="introduction"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#introduction"></a></h2>
   <p><em>This section is non-normative.</em></p>
   <p>The <span class="title">Per Resource Events Protocol</span> defines a minimal HTTP-based framework by which clients can securely receive update notifications directly from any resource of interest on the Open Web Platform.</p>
   <h3 class="heading settled" data-level="1.1" id="motivation"><span class="secno">1.1. </span><span class="content">Motivation</span><a class="self-link" href="#motivation"></a></h3>
   <p><em>This section is non-normative.</em></p>
   <p>HTTP was originally designed to transfer a static documents within a single request and response. If the document changes, HTTP does not automatically update clients with the new versions. This design was adequate for web pages that were mostly static and written by hand.</p>
   <p>But web-applications today are dynamic. They provide (near-)instantaneous updates across multiple clients and servers. The many workarounds developed over the years to provide real-time updates over HTTP have often proven to be inadequate. Web programmers instead resort to implementing custom messaging systems over alternate protocols such as WebSockets, which requires additional layers of code in the form of non-standard JavaScript frameworks to synchronize changes of state.</p>
   <p>Per Resource Events is a minimal protocol built on top of HTTP that allows clients to receive notifications directly from a resource of interest. Unlike other HTTP based solutions, <span class="title">Per Resource Events Protocol</span> supports the use of arbitrary media-types for notifications, which can be negotiated just like representations; thus giving implementers a lot of flexibility to customize notifications according to the needs of their application.</p>
   <h3 class="heading settled" data-level="1.2" id="how-it-works"><span class="secno">1.2. </span><span class="content">How it Works</span><a class="self-link" href="#how-it-works"></a></h3>
   <p><em>This section is non-normative.</em></p>
   <p>A client application that wishes to receive notifications about updates to a resource simply places a `GET` request on that resource with just one additional `Accept-Events` header. The server responds by sending, first the current representation of the resource (though a client can request for this to be skipped), followed by notifications sent in response to resource events as parts of a multipart response while the request is open.</p>
   <p>If a server does not implement the <span class="title">Per Resource Events Protocol</span>, the `Accept Events` header in a `GET` request is simply ignored. The resource returns the current representation thereby preserving backwards compatibility.</p>
   <h3 class="heading settled" data-level="1.3" id="scope"><span class="secno">1.3. </span><span class="content">Scope</span><a class="self-link" href="#scope"></a></h3>
   <p><em>This section is non-normative.</em></p>
   <p>The <span class="title">Per Resource Events Protocol</span> specifies:</p>
   <ul>
    <li data-md>
     <p>a mechanism for the discovery of notification capabilities per resource,</p>
    <li data-md>
     <p>a mechanism to request notifications from a resource,</p>
    <li data-md>
     <p>representation and semantics for the response that transmits notifications (but not the representation and semantics for notifications themselves, see below),</p>
   </ul>
   <div class="v-space"></div>
   <p>The <span class="title">Per Resource Events Protocol</span> does not specify:</p>
   <ul>
    <li data-md>
     <p>a specific authentication and authorization mechanism to be used with the <span class="title">Per Resource Events Protocol</span>. Implementations are encouraged to use existing approaches for authentication and authorization.</p>
    <li data-md>
     <p>representation and semantics for notifications.</p>
     <ul>
      <li data-md>
       <p>Implementations are free to use any media-type for notifications, which can be negotiated just like the content-type for the representation of the state of the resource.</p>
      <li data-md>
       <p>Implementations are also free to define additional semantics for a given media-type when used to transmit notifications using the <span class="title">Per Resource Events Protocol</span>. As an appendix to this specification, we define additional semantics for the `message/rfc822` MIME type when used for <span class="shortname">PREP</span> notifications.</p>
     </ul>
   </ul>
   <h3 class="heading settled" data-level="1.4" id="intended-audience"><span class="secno">1.4. </span><span class="content">Audience</span><a class="self-link" href="#intended-audience"></a></h3>
   <p><em>This section is non-normative.</em></p>
   <p>This specification is for:</p>
   <ul>
    <li data-md>
     <p><a href="http://data.europa.eu/esco/occupation/a7c1d23d-aeca-4bee-9a08-5993ed98b135">Server developers</a> who wish to enable clients to listen for updates to particular resources.</p>
    <li data-md>
     <p><a href="http://data.europa.eu/esco/occupation/c40a2919-48a9-40ea-b506-1f34f693496d">Application developers</a> who wish to implement a client to listen for updates to particular resources.</p>
   </ul>
   <h2 class="heading settled" data-level="2" id="design"><span class="secno">2. </span><span class="content">Design</span><a class="self-link" href="#design"></a></h2>
   <p><em>This section is non-normative.</em></p>
   <p>The <span class="title">Per Resource Events Protocol</span> is predicated on a resource being the most intuitive source for notifications about its own updates.</p>
   <p>This is unlike other notification protocols that require additional resources to be specifically dedicated as endpoints for delivering notifications. Servers that provide updates are forced to maintain these additional endpoints and clients that consume these updates have to co-ordinate data between the endpoint and a resource of interest.</p>
   <p>By giving every resource the ability to send notifications when it updates, the <span class="title">Per Resource Events Protocol</span> aims to reduce the complexity of  both servers and clients implementing notifications; thus, making it easier for developers to build and maintain real-time applications.</p>
   <h3 class="heading settled" data-level="2.1" id="principles"><span class="secno">2.1. </span><span class="content">Principles</span><a class="self-link" href="#principles"></a></h3>
   <p><em>This section is non-normative.</em></p>
   <p>The <span class="title">Per Resource Events Protocol</span> treats notifications as a temporally extended representation of any resource. That is, a representation can describe not (just) the state of the resource but events on the resource. With HTTP allowing representations to provide a potentially unbounded stream of data, the <span class="title">Per Resource Events Protocol</span> is able to communicate events on the resource as notifications.</p>
   <h3 class="heading settled" data-level="2.2" id="goals"><span class="secno">2.2. </span><span class="content">Goals</span><a class="self-link" href="#goals"></a></h3>
   <p><em>This section is non-normative.</em></p>
   <p>The goals of the <span class="title">Per Resource Events Protocol</span> are:</p>
   <ul>
    <li data-md>
     <p>to provide notifications only using the HTTP protocol <a href="https://www.rfc-editor.org/info/std97">STD 97</a> <a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> so that the clients are able to request for update notifications using the Fetch API <a data-link-type="biblio" href="#biblio-fetch" title="Fetch Standard">[FETCH]</a>.</p>
    <li data-md>
     <p>to provide updates directly from the resource of interest, obliviating the need to connect to another endpoint for notifications, minimizing round-trips between clients and servers and the need to co-ordinate responses between a resource and the endpoint.</p>
    <li data-md>
     <p>to allow arbitrary representations for notifications. Implementers shall be able to provide notifications that are potentially more expressive when compared to existing HTTP based messaging protocols such as Server Sent Events <a data-link-type="biblio" href="#biblio-eventsource" title="Server-Sent Events">[EVENTSOURCE]</a>.</p>
   </ul>
   <h3 class="heading settled" data-level="2.3" id="constraints"><span class="secno">2.3. </span><span class="content">Constraints</span><a class="self-link" href="#constraints"></a></h3>
   <p><em>This section is non-normative.</em></p>
   <p>To the extent feasible, the <span class="title">Per Resource Events Protocol</span>:</p>
   <ul>
    <li data-md>
     <p>adheres to established practices and conventions. In particular, every attempt has been made to reuse existing protocols and specifications. Implementers shall be able to repurpose existing tools and libraries for implementing this specification.</p>
    <li data-md>
     <p>conforms to the REST Architectural Style <a data-link-type="biblio" href="#biblio-rest" title="Architectural styles and the design of network-based software architectures">[REST]</a> and best practices for Building Protocols with HTTP <a data-link-type="biblio" href="#biblio-rfc9205" title="Building Protocols with HTTP">[RFC9205]</a>. This specification can, thus, be used to extend the capabilities of any existing HTTP resource to provide notifications. Implementers shall be able to scale notifications along with their data/applications. </p>
   </ul>
   <h3 class="heading settled" data-level="2.4" id="known-limitations"><span class="secno">2.4. </span><span class="content">Known Limitations</span><a class="self-link" href="#known-limitations"></a></h3>
   <p><em>This section is non-normative.</em></p>
   <p>The <span class="title">Per Resource Events Protocol</span> only allows notifications to be sent for events on a given resource. It is not possible for resources to send notifications for arbitrary events such as state changes on multiple resources or combinations thereof. Implementations using <span class="title">Per Resource Events Protocol</span> have to create separate resources to realize such notification endpoints. But this is no different from APIs built on top of existing messaging protocols (See, for example, <a data-link-type="biblio" href="#biblio-websockets" title="WebSockets Standard">[WEBSOCKETS]</a> and <a data-link-type="biblio" href="#biblio-websub" title="WebSub">[WEBSUB]</a>).</p>
   <p>Due to the limits on connections per domain, the <span class="title">Per Resource Events Protocol</span> is not suitable for use with HTTP/1.1, especially when providing notifications for multiple resource from the same domain that might be accessed simultaneously. This limitation is identical to that of other HTTP based streaming based protocols such as Server-Sent Events <a data-link-type="biblio" href="#biblio-eventsource" title="Server-Sent Events">[EVENTSOURCE]</a>. Implementations are strongly encouraged to adopt HTTP/2 (or later) and implement mitigation strategies, such as to maximize the number of concurrent connections and to provide alternate locations for resources on different domains.</p>
   <h2 class="heading settled" data-level="3" id="terminology"><span class="secno">3. </span><span class="content">Terminology</span><a class="self-link" href="#terminology"></a></h2>
   <dl>
    <dt data-md><dfn data-dfn-type="dfn" data-noexport id="notification">Notification<a class="self-link" href="#notification"></a></dfn>
    <dd data-md>
     <p>A message sent to <a data-link-type="dfn" href="#application-client" id="ref-for-application-client①">application clients</a> (that had previously requested it) when an HTTP request made on a resource fulfils some specified criteria.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="base-response">Base Response</dfn>
    <dd data-md>
     <p>The response that would have been returned were notifications not requested for in an otherwise identical HTTP request.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="event-field">Event Field</dfn>
    <dd data-md>
     <p>A parameter for a protocol item in the <span>`<code><a data-link-type="http-header" href="#accept-events-header" id="ref-for-accept-events-header">Accept-Events</a></code>`</span> header field or a member of the <span>`<code><a data-link-type="http-header" href="#events-header" id="ref-for-events-header">Events</a></code>`</span> header field.</p>
   </dl>
   <h2 class="heading settled" data-level="4" id="header-fields"><span class="secno">4. </span><span class="content">Header Fields</span><a class="self-link" href="#header-fields"></a></h2>
   <p>The <span class="title">Per Resource Events Protocol</span> introduces new header fields. These header fields are not specific to the <span class="title">Per Resource Events Protocol</span>. They can be used by other protocols that augment resources with the ability to send notifications.</p>
   <p>Protocols MUST ensure that the semantics be so defined that these header fields are safely ignored by recipients that do not recognize them (<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-5.1">§ 5.1 Field Names</a>).</p>
   <h3 class="heading settled dfn-paneled" data-dfn-type="http-header" data-export data-level="4.1" data-lt="Accept-Events" id="accept-events-header"><span class="secno">4.1. </span><span class="content"> Accept-Events </span><a class="self-link" href="#accept-events-header" id="ref-for-accept-events-header②⑦"></a></h3>
   <p>The <span>`<code><a data-link-type="http-header" href="#accept-events-header" id="ref-for-accept-events-header①">Accept-Events</a></code>`</span> header field can be used by <a data-link-type="dfn" href="#application-client" id="ref-for-application-client②">application clients</a> to specify their preferred protocol for receiving notifications. For example, the <span>`<code><a data-link-type="http-header" href="#accept-events-header" id="ref-for-accept-events-header②">Accept-Events</a></code>`</span> header field can be used to indicate that the request is specifically limited to a small set of desired protocols, as in the case for notifications with the <span class="title">Per Resource Events Protocol</span>.</p>
   <p>When sent by a <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server①">resource server</a> in a response, the <span>`<code><a data-link-type="http-header" href="#accept-events-header" id="ref-for-accept-events-header③">Accept-Events</a></code>`</span> header field provides information about which notification protocols are preferred in a subsequent request to the same resource.</p>
   <p>An <a data-link-type="dfn" href="#application-client" id="ref-for-application-client③">application client</a> MAY generate a request for notifications regardless of having received an <span>`<code><a data-link-type="http-header" href="#accept-events-header" id="ref-for-accept-events-header④">Accept-Events</a></code>`</span> header field. The information only provides advice for the sake of improving performance and reducing unnecessary network transfers.</p>
   <p>Conversely, an <a data-link-type="dfn" href="#application-client" id="ref-for-application-client④">application client</a> MUST NOT assume that receiving an <span>`<code><a data-link-type="http-header" href="#accept-events-header" id="ref-for-accept-events-header⑤">Accept-Events</a></code>`</span> header field means that future requests will return notifications. The content might change, the server might only support notifications requests at certain times or under certain conditions, or a different intermediary might process the next request.</p>
   <h4 class="heading settled" data-level="4.1.1" id="accept-events-header-validity"><span class="secno">4.1.1. </span><span class="content">Validity</span><a class="self-link" href="#accept-events-header-validity"></a></h4>
   <p>A recipient MUST ignore the <span>`<code><a data-link-type="http-header" href="#accept-events-header" id="ref-for-accept-events-header⑥">Accept-Events</a></code>`</span> header field received with a request method that is unrecognized or for which notifications response is not defined for a particular notifications protocol.</p>
   <p>A recipient MUST ignore the <span>`<code><a data-link-type="http-header" href="#accept-events-header" id="ref-for-accept-events-header⑦">Accept-Events</a></code>`</span> header field received in response to a request method that is unrecognized or for which notifications discovery and/or response is not defined for a particular notifications protocol.</p>
   <p>A recipient MUST ignore the <span>`<code><a data-link-type="http-header" href="#accept-events-header" id="ref-for-accept-events-header⑧">Accept-Events</a></code>`</span> header field that it does not understand.</p>
   <div class="issue" id="issue-2915c8b6">
    <a class="self-link" href="#issue-2915c8b6"></a> 
    <p>Where a recipient receives an illegal <span>`<code><a data-link-type="http-header" href="#accept-events-header" id="ref-for-accept-events-header⑨">Accept-Events</a></code>`</span> header field, can we:</p>
    <ul>
     <li data-md>
      <p>Ignore it (as we do now)</p>
     <li data-md>
      <p>Send an error message. If so what could be the form of the error message?</p>
    </ul>
   </div>
   <p>A recipient MUST ignore the protocols specified in the <span>`<code><a data-link-type="http-header" href="#accept-events-header" id="ref-for-accept-events-header①⓪">Accept-Events</a></code>`</span> header field that they are not aware of.</p>
   <h4 class="heading settled" data-level="4.1.2" id="accept-events-header-syntax"><span class="secno">4.1.2. </span><span class="content">Syntax</span><a class="self-link" href="#accept-events-header-syntax"></a></h4>
   <p><span>`<code><a data-link-type="http-header" href="#accept-events-header" id="ref-for-accept-events-header①①">Accept-Events</a></code>`</span> is a List structured (<a data-link-type="biblio" href="#biblio-structured-fields" title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</a> <a href="https://datatracker.ietf.org/doc/draft-ietf-httpbis-sfbis/03/#section-3.1">§ 3.1 Lists</a>) header field. Its members MUST be of type string that identifies a notification protocol. A protocol identifier MAY be followed with zero or more parameters defined by the given protocol, which MAY be followed by a <span>`<code><a data-link-type="http-header">q</a></code>`</span> parameter.</p>
   <p class="issue" id="issue-61bfc96f"><a class="self-link" href="#issue-61bfc96f"></a> Could the protocol identifier be a URL?</p>
   <p class="issue" id="issue-e3fb2d54"><a class="self-link" href="#issue-e3fb2d54"></a> If the protocol is an identifier, do we need to define a registry?</p>
   <p>The <dfn data-dfn-type="http-header" data-export id="http-headerdef-q">`q`<a class="self-link" href="#http-headerdef-q"></a></dfn> parameter assigns a relative "weight" to the sender’s preference for a notification protocol with semantics as defined in <a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-12.4.2">§ 12.4.2 Quality Values</a>. Senders using weights SHOULD send <span>`<code><a data-link-type="http-header">q</a></code>`</span> last (after all protocol parameters). Recipients SHOULD process any parameter named <span>`<code><a data-link-type="http-header">q</a></code>`</span> as weight, regardless of parameter ordering.</p>
   <p class="note" role="note"><span class="marker">Note:</span> Use of the <span>`<code><a data-link-type="http-header">q</a></code>`</span> parameter name to negotiate notification protocols would interfere with any parameter having the same name. Hence, protocol parameters named <span>`<code><a data-link-type="http-header">q</a></code>`</span> are disallowed.</p>
   <h3 class="heading settled dfn-paneled" data-dfn-type="http-header" data-export data-level="4.2" data-lt="Events" id="events-header"><span class="secno">4.2. </span><span class="content"> Events </span><a class="self-link" href="#events-header" id="ref-for-events-header②⓪"></a></h3>
   <p>The <span>`<code><a data-link-type="http-header" href="#events-header" id="ref-for-events-header①">Events</a></code>`</span> header field is sent by a <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server②">resource server</a> to provide event fields in response to a request for notifications.</p>
   <p>Where the <span>`<code><a data-link-type="http-header" href="#accept-events-header" id="ref-for-accept-events-header①②">Accept-Events</a></code>`</span> header field sent in the request is ignored, a <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server③">resource server</a> MUST NOT send the <span>`<code><a data-link-type="http-header" href="#events-header" id="ref-for-events-header②">Events</a></code>`</span> header field in a response.</p>
   <p>Conversely, a <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server④">resource server</a> MUST send the <span>`<code><a data-link-type="http-header" href="#events-header" id="ref-for-events-header③">Events</a></code>`</span> header field in a response, if the <span>`<code><a data-link-type="http-header" href="#accept-events-header" id="ref-for-accept-events-header①③">Accept-Events</a></code>`</span> header field sent in the request is not ignored.</p>
   <h4 class="heading settled" data-level="4.2.1" id="events-header-validity"><span class="secno">4.2.1. </span><span class="content">Validity</span><a class="self-link" href="#events-header-validity"></a></h4>
   <p>If the <span>`<code><a data-link-type="http-header" href="#events-header" id="ref-for-events-header④">Events</a></code>`</span> header field is sent in response to a request that does not contain the <span>`<code><a data-link-type="http-header" href="#accept-events-header" id="ref-for-accept-events-header①④">Accept-Events</a></code>`</span> header field, the recipient MUST treat the response as invalid.</p>
   <p class="issue" id="issue-89e8a754"><a class="self-link" href="#issue-89e8a754"></a> Does compliance with HTTP demand that we ignore the <span>`<code><a data-link-type="http-header" href="#events-header" id="ref-for-events-header⑤">Events</a></code>`</span> header? How will recipient process such a response that presumably contains notifications that it has not requested?</p>
   <p>If the response contains a <span>`<code><a data-link-type="http-header" href="#events-header" id="ref-for-events-header⑥">Events</a></code>`</span> header field that the recipient does not understand or the <span>`<code><a data-link-type="http-header" href="#events-header" id="ref-for-events-header⑦">Events</a></code>`</span> header field specifies a `protocol` that the recipient does not understand, the recipient MUST NOT process the response. A proxy that receives such a message SHOULD forward it downstream.</p>
   <p class="issue" id="issue-e5765590"><a class="self-link" href="#issue-e5765590"></a> Could the constraints on the <span>`<code><a data-link-type="http-header" href="#events-header" id="ref-for-events-header⑧">Events</a></code>`</span> field not being understood be more specific? <br> <br> Such as: <br> "A recipient MUST ignore the <span>`<code><a data-link-type="http-header" href="#events-header" id="ref-for-events-header⑨">Events</a></code>`</span> header field received in response to a request method that is unrecognized or for which notifications response is not defined for a particular notifications protocol."</p>
   <h4 class="heading settled" data-level="4.2.2" id="events-header-syntax"><span class="secno">4.2.2. </span><span class="content">Syntax</span><a class="self-link" href="#events-header-syntax"></a></h4>
   <p><span>`<code><a data-link-type="http-header" href="#events-header" id="ref-for-events-header①⓪">Events</a></code>`</span> is a Dictionary structured (<a data-link-type="biblio" href="#biblio-structured-fields" title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</a> <a href="https://datatracker.ietf.org/doc/draft-ietf-httpbis-sfbis/03/#section-3.2">§ 3.2 Dictionaries</a>) header field. It MUST contain one member with the key `protocol` whose value identifies the notification protocol used in the response. It MAY contain other members that are defined by the given notification protocol.</p>
   <h2 class="heading settled" data-level="5" id="protocol"><span class="secno">5. </span><span class="content">Protocol</span><a class="self-link" href="#protocol"></a></h2>
   <h3 class="heading settled" data-level="5.1" id="event-fields"><span class="secno">5.1. </span><span class="content">Event Fields</span><a class="self-link" href="#event-fields"></a></h3>
   <p>The <span class="title">Per Resource Events Protocol</span> reuses existing HTTP fields (<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-5">§ 5 Fields</a>) as event fields. Any HTTP field MAY be used as an <a data-link-type="dfn" href="#event-field" id="ref-for-event-field">event field</a>. For the limited context of notifications using the <span class="title">Per Resource Events Protocol</span>, an <a data-link-type="dfn" href="#event-field" id="ref-for-event-field①">event field</a> with the same name as an HTTP field MUST have identical semantics to that HTTP field, unless otherwise specified.</p>
   <p>This specification restricts <span>`<code><a data-link-type="http-header" href="#accept-events-header" id="ref-for-accept-events-header①⑤">Accept-Events</a></code>`</span> and <span>`<code><a data-link-type="http-header" href="#events-header" id="ref-for-events-header①①">Events</a></code>`</span> as Structured header fields <a data-link-type="biblio" href="#biblio-structured-fields" title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</a>. From this it follows:</p>
   <ul>
    <li data-md>
     <p>An event field whose value is anything except an item without parameters MUST be specified in an Inner List (<a data-link-type="biblio" href="#biblio-structured-fields" title="Structured Field Values for HTTP">[STRUCTURED-FIELDS]</a> <a href="https://datatracker.ietf.org/doc/draft-ietf-httpbis-sfbis/03/#section-3.1.1">§ 3.1.1 Inner List</a>).</p>
    <li data-md>
     <p>Unless otherwise specified, an <a data-link-type="dfn" href="#event-field" id="ref-for-event-field②">event field</a> that is not already defined as a Structured Field, therefore, MUST be handled as a Retrofit Structured Field <a data-link-type="biblio" href="#biblio-retrofit-fields" title="Retrofit Structured Fields for HTTP">[RETROFIT-FIELDS]</a> when such handling is defined.</p>
    <li data-md>
     <p>An <a data-link-type="dfn" href="#event-field" id="ref-for-event-field③">event field</a> that is not already defined as a Structured Field but cannot be handled as a Retrofit Structured Field either, MUST be explicitly specified by the implementation.</p>
   </ul>
   <h3 class="heading settled" data-level="5.2" id="methods"><span class="secno">5.2. </span><span class="content">Methods</span><a class="self-link" href="#methods"></a></h3>
   <p>For the <span class="title">Per Resource Events Protocol</span>, `HEAD` (<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-9.3.2">§ 9.3.2 HEAD</a>) and `GET` (<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-9.3.1">§ 9.3.1 GET</a>) are the only methods in response to which notifications are advertised.</p>
   <p>A <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server⑤">resource server</a> MUST NOT send the <span>`<code><a data-link-type="http-header" href="#accept-events-header" id="ref-for-accept-events-header①⑥">Accept-Events</a></code>`</span> header field with `PREP` as a protocol in response to a request with any method other than `HEAD` or `GET`.</p>
   <p>For the <span class="title">Per Resource Events Protocol</span>, `GET` (<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-9.3.1">§ 9.3.1 GET</a>) is the only method by which notifications are requested and for which notifications response is defined.</p>
   <p>An <a data-link-type="dfn" href="#application-client" id="ref-for-application-client⑤">application client</a> MUST NOT send the <span>`<code><a data-link-type="http-header" href="#accept-events-header" id="ref-for-accept-events-header①⑦">Accept-Events</a></code>`</span> header field with `PREP` as a protocol in a request with any method other than `GET`.</p>
   <p>An <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server⑥">resource server</a> MUST NOT send the <span>`<code><a data-link-type="http-header" href="#events-header" id="ref-for-events-header①②">Events</a></code>`</span> header field with the parameter `protocol` with a value of `PREP` in response to a request with any method other than `GET`.</p>
   <p>A <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server⑦">resource server</a> MUST NOT send the <span>`<code><a data-link-type="http-header" href="#events-header" id="ref-for-events-header①③">Events</a></code>`</span> header field except in response to a `GET` request.</p>
   <h3 class="heading settled" data-level="5.3" id="status-codes"><span class="secno">5.3. </span><span class="content">Status Codes</span><a class="self-link" href="#status-codes"></a></h3>
   <p>The <span class="title">Per Resource Events Protocol</span> reuses existing HTTP status codes (<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-15">§ 15 Status Codes</a>) to describe the result of the request for notifications and the semantics of notifications in the response.</p>
   <p>In response to a request where <span>`<code><a data-link-type="http-header" href="#accept-events-header" id="ref-for-accept-events-header①⑧">Accept-Events</a></code>`</span> header field indicates `PREP` as the preferred protocol, a <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server⑧">resource server</a> that supports notifications using the <span class="title">Per Resource Events Protocol</span> MUST communicate the status code for the notifications response using the `status` parameter in the <span>`<code><a data-link-type="http-header" href="#events-header" id="ref-for-events-header①④">Events</a></code>`</span> header field.</p>
   <p>For the limited context of notifications using the <span class="title">Per Resource Events Protocol</span>, the status code communicated using the `status` parameter in the <span>`<code><a data-link-type="http-header" href="#events-header" id="ref-for-events-header①⑤">Events</a></code>`</span> header field MUST have identical semantics to the corresponding HTTP status code, unless otherwise specified.</p>
   <h2 class="heading settled" data-level="6" id="notifications-discovery"><span class="secno">6. </span><span class="content">Discovery</span><a class="self-link" href="#notifications-discovery"></a></h2>
   <p><a data-link-type="dfn" href="#application-client" id="ref-for-application-client⑥">Application clients</a> can engage in reactive content negotiation to discover if a <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server⑨">resource server</a> supports notifications using the <span class="title">Per Resource Events Protocol</span> on a given resource.</p>
   <h3 class="heading settled" data-level="6.1" id="discovery-request"><span class="secno">6.1. </span><span class="content">Request</span><a class="self-link" href="#discovery-request"></a></h3>
   <p>An <a data-link-type="dfn" href="#application-client" id="ref-for-application-client⑦">application client</a> can discover the ability of a <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server①⓪">resource server</a> to deliver <span class="shortname">PREP</span> notifications for a target resource by sending a `HEAD` (<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-9.3.2">§ 9.3.2 HEAD</a>) request.</p>
   <h3 class="heading settled" data-level="6.2" id="discovery-response-when-notifications-not-available"><span class="secno">6.2. </span><span class="content">Not Available</span><a class="self-link" href="#discovery-response-when-notifications-not-available"></a></h3>
   <p>In the response to a `HEAD` request, a <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server①①">resource server</a> that does not provide notifications for the target resource using the <span class="title">Per Resource Events Protocol</span> MUST NOT list `PREP` as as one of the available protocols in the <span>`<code><a data-link-type="http-header" href="#accept-events-header" id="ref-for-accept-events-header①⑨">Accept-Events</a></code>`</span> header field.</p>
   <h3 class="heading settled" data-level="6.3" id="discovery-response-when-notifications-available"><span class="secno">6.3. </span><span class="content">Available</span><a class="self-link" href="#discovery-response-when-notifications-available"></a></h3>
   <p>In response to a `HEAD` request, a <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server①②">resource server</a> that serves notifications for the target resource using the <span class="title">Per Resource Events Protocol</span> SHOULD include the <span>`<code><a data-link-type="http-header" href="#accept-events-header" id="ref-for-accept-events-header②⓪">Accept-Events</a></code>`</span> header field, which MUST list `PREP` as one of the available protocols.</p>
   <p>Associated with `PREP` list item, the <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server①③">resource server</a> MUST include an `accept` <a data-link-type="dfn" href="#event-field" id="ref-for-event-field④">event field</a> with at least one acceptable media-type for notifications.</p>
   <div class="example" id="example-a292e631"><a class="self-link" href="#example-a292e631"></a> <span class="marker">Notifications Discovery</span> <br> <cite>Discovery request:</cite> <prep-http-tabs> <div slot="http"> <pre class="include-code highlight"><c- nf>HEAD</c-> <c- nn>/foo</c-> <c- kr>HTTP</c-><c- o>/</c-><c- m>1.1</c->
<c- e>Host</c-><c- o>:</c-> <c- l>example.org</c->
</pre> </div> <div slot="http2"> <pre class="include-code highlight"><c- n>HEADERS</c->
  + <c- n>END_HEADERS</c->
  + <c- n>END_STREAM</c->
    <c- p>:</c-><c- n>method</c-> <c- o>=</c-> <c- n>HEAD</c->
    <c- p>:</c-><c- n>scheme</c-> <c- o>=</c-> <c- n>https</c->
    <c- p>:</c-><c- n>authority</c-> <c- o>=</c-> <c- n>example</c-><c- p>.</c-><c- n>org</c->
    <c- p>:</c-><c- n>path</c-> <c- o>=</c-> /<c- n>foo</c->
</pre> </div> </prep-http-tabs> <br> <cite>Discovery response:</cite> <br> <prep-http-tabs> <div slot="http"> <pre class="include-code highlight"><c- kr>HTTP</c-><c- o>/</c-><c- m>1.1</c-> <c- m>200</c-> <c- ne>OK</c->
<c- e>Accept</c-><c- o>:</c-> <c- l>text/html</c->
<c- e>Accept-Events</c-><c- o>:</c-> <c- l>PREP; accept=message/rfc822</c->
</pre> </div> <div slot="http2"> <pre class="include-code highlight"><c- n>HEADERS</c->
  + <c- n>END_HEADERS</c->
  + <c- n>END_STREAM</c->
    <c- p>:</c-><c- n>status</c-> <c- o>=</c-> <c- mi>304</c->
    <c- n>accept</c-> <c- o>=</c-> <c- n>text</c->/<c- n>html</c->
    <c- n>accept-events</c-><c- p>:</c-> <c- n>PREP</c-><c- p>;</c-> <c- n>accept</c-><c- o>=</c-><c- n>message</c->/<c- n>rfc822</c->
</pre> </div> </prep-http-tabs> </div>
   <div class="advisement">
    <div class="marker">Implementation Guidance</div>
    <p>When <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server①④">resource servers</a> support HTTP/2 <a data-link-type="biblio" href="#biblio-rfc9113" title="HTTP/2">[RFC9113]</a> for a resource, they are strongly encouraged to advertise it in the response.</p>
    <p>When a resource is accessible from different locations, <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server①⑤">resource servers</a> are encouraged to advertise these locations in the response.</p>
    <p>HTTP Alternative Services <a data-link-type="biblio" href="#biblio-rfc7838" title="HTTP Alternative Services">[RFC7838]</a>, for example, describes a mechanism for advertising these capabilities.</p>
   </div>
   <h2 class="heading settled" data-level="7" id="request"><span class="secno">7. </span><span class="content">Request</span><a class="self-link" href="#request"></a></h2>
   <p>The <span class="title">Per Resource Events Protocol</span> extends the content negotiation mechanism provided by HTTP allowing <a data-link-type="dfn" href="#application-client" id="ref-for-application-client⑧">application clients</a> to negotiate notifications independent of the <a data-link-type="dfn" href="#base-response" id="ref-for-base-response">base response</a>.</p>
   <p>In order to receive notifications using the <span class="title">Per Resource Events Protocol</span> from a resource, an <a data-link-type="dfn" href="#application-client" id="ref-for-application-client⑨">application client</a> sends a `GET` request to <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server①⑥">resource server</a>, which:</p>
   <ul>
    <li data-md>
     <p>MUST include the <span>`<code><a data-link-type="http-header" href="#accept-events-header" id="ref-for-accept-events-header②①">Accept-Events</a></code>`</span> header field, which:</p>
     <ul>
      <li data-md>
       <p>MUST list `PREP` as a preferred notification protocol.</p>
       <ul>
        <li data-md>
         <p>MAY include zero or more <a data-link-type="dfn" href="#event-field" id="ref-for-event-field⑤">event fields</a>. For example, <a data-link-type="dfn" href="#application-client" id="ref-for-application-client①⓪">application clients</a> MAY specify an `accept` <a data-link-type="dfn" href="#event-field" id="ref-for-event-field⑥">event field</a> to indicate a preferred media-type for notifications.</p>
       </ul>
     </ul>
    <li data-md>
     <p>MAY include the `Last-Event-ID` header field (<a data-link-type="biblio" href="#biblio-eventsource" title="Server-Sent Events">[EVENTSOURCE]</a> <a href="https://html.spec.whatwg.org/multipage/server-sent-events.html#section-9.2.4">§ 9.2.4  The `Last-Event-ID` header</a>) requesting the <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server①⑦">resource server</a> to not send the <a data-link-type="dfn" href="#base-response" id="ref-for-base-response①">base response</a> body and resume notifications from the event occurring immediately after the one specified.</p>
   </ul>
   <div class="advisement">
    <div class="marker">Implementation Guidance</div>
    <p>Set the `Last-Event-ID` to a wildcard `*` to explicitly request a <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server①⑧">resource server</a> to not send the <a data-link-type="dfn" href="#base-response" id="ref-for-base-response②">base response</a> body in the response at all.</p>
   </div>
   <div class="v-space"></div>
   <div class="example" id="example-4aae86aa"><a class="self-link" href="#example-4aae86aa"></a> <span class="marker">Request for Notifications</span> <prep-http-tabs> <div slot="http"> <pre class="include-code highlight"><c- nf>GET</c-> <c- nn>/foo</c-> <c- kr>HTTP</c-><c- o>/</c-><c- m>1.1</c->
<c- e>Host</c-><c- o>:</c-> <c- l>example.org</c->
<c- e>Authorization</c-><c- o>:</c-> <c- l>DPoP &lt;token></c->
<c- e>DPoP</c-><c- o>:</c-> <c- l>&lt;proof></c->
<c- e>Last-Event-ID</c-><c- o>:</c-> <c- l>*</c->
<c- e>Accept-Encoding</c-><c- o>:</c-> <c- l>gzip</c->
<c- e>Accept-Events</c-><c- o>:</c-> <c- l>PREP; accept=message/rfc822; accept-encoding=identity</c->
</pre> </div> <div slot="http2"> <pre class="include-code highlight"><c- n>HEADERS</c->
  + <c- n>END_STREAM</c->
  - <c- n>END_HEADERS</c->
    <c- p>:</c-><c- n>method</c-> <c- o>=</c-> <c- n>GET</c->
    <c- p>:</c-><c- n>scheme</c-> <c- o>=</c-> <c- n>https</c->
    <c- p>:</c-><c- n>authority</c-> <c- o>=</c-> <c- n>example</c-><c- p>.</c-><c- n>org</c->
    <c- p>:</c-><c- n>path</c-> <c- o>=</c-> /<c- n>foo</c->

<c- n>CONTINUATION</c->
  + <c- n>END_HEADERS</c->
    <c- n>authorization</c-> <c- o>=</c-> <c- n>DPoP</c-> &lt;<c- n>token</c->>
    <c- n>DPoP</c-> <c- o>=</c-> &lt;<c- n>proof</c->>
    <c- n>last-event-id</c-> <c- o>=</c-> *
    <c- n>accept-encoding</c-> <c- o>=</c-> <c- n>gzip</c->
    <c- n>accept-events</c-> <c- o>=</c-> <c- n>PREP</c-><c- p>;</c-> <c- n>accept</c-><c- o>=</c-><c- n>message</c->/<c- n>rfc822</c-><c- p>;</c-> <c- n>accept-encoding</c-><c- o>=</c-><c- n>identity</c->
</pre> </div> </prep-http-tabs> </div>
   <p>A <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server①⑨">resource server</a> MUST ignore <a data-link-type="dfn" href="#event-field" id="ref-for-event-field⑦">event fields</a> for `PREP` notifications in the <span>`<code><a data-link-type="http-header" href="#accept-events-header" id="ref-for-accept-events-header②②">Accept-Events</a></code>`</span> header that it does not recognize or implement.</p>
   <p></p>
   <h2 class="heading settled" data-level="8" id="response-without-notifications"><span class="secno">8. </span><span class="content">Response without Notifications</span><a class="self-link" href="#response-without-notifications"></a></h2>
   <h3 class="heading settled" data-level="8.1" id="response-when-notifications-not-available"><span class="secno">8.1. </span><span class="content">Not Available</span><a class="self-link" href="#response-when-notifications-not-available"></a></h3>
   <p>A <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server②⓪">resource server</a> not implementing the <span class="title">Per Resource Events Protocol</span> (or not supporting it for the target resource) can ignore a request for notifications and respond as if it received a normal request on that resource without impacting interoperability.</p>
   <p>A <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server②①">resource server</a> that does not provide notifications using the <span class="title">Per Resource Events Protocol</span> MUST NOT:</p>
   <ul>
    <li data-md>
     <p>list `PREP` as as one of the available protocols in the <span>`<code><a data-link-type="http-header" href="#accept-events-header" id="ref-for-accept-events-header②③">Accept-Events</a></code>`</span> header field, if sent in the response.</p>
    <li data-md>
     <p>send the <span>`<code><a data-link-type="http-header" href="#events-header" id="ref-for-events-header①⑥">Events</a></code>`</span> header field in the response with the `protocol` event field set to `PREP`.</p>
   </ul>
   <div class="advisement">
    <div class="marker">Implementation Guidance</div>
    <p>Implementations are advised against sending notifications for long-lived resources. A resource might be considered long-lived, if the <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server②②">resource server</a> determines that the resource is unlikely to change in the duration of the notification response. In such instances, <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server②③">resource servers</a> are strongly advised to respond with the `Cache-Control` header and set the `max-age` parameter in it.</p>
   </div>
   <h3 class="heading settled" data-level="8.2" id="error-response"><span class="secno">8.2. </span><span class="content">Error Response</span><a class="self-link" href="#error-response"></a></h3>
   <p>A <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server②④">resource server</a> MUST NOT include <span class="shortname">PREP</span> notifications in a response, unless request results in one of the following status codes:</p>
   <ul>
    <li data-md>
     <p>`200 (OK)` (<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-15.3.1">§ 15.3.1 200 OK</a>),</p>
    <li data-md>
     <p>`204 (No Content)` (<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-15.3.5">§ 15.3.5 204 No Content</a>),</p>
    <li data-md>
     <p>`206 (Partial Content)` (<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-15.3.7">§ 15.3.7 206 Partial Content</a>),</p>
    <li data-md>
     <p>`226 (IM Used)` (<a data-link-type="biblio" href="#biblio-rfc3229" title="Delta encoding in HTTP">[RFC3229]</a> <a href="https://www.rfc-editor.org/rfc/rfc3229#section-10.4.1">§ 10.4.1 226 IM Used</a>).</p>
   </ul>
   <p>A <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server②⑤">resource server</a> that does not serve <span class="shortname">PREP</span> notifications, on account of the response not having one of the above-mentioned status codes:</p>
   <ul>
    <li data-md>
     <p>SHOULD include the <span>`<code><a data-link-type="http-header" href="#events-header" id="ref-for-events-header①⑦">Events</a></code>`</span> header fields where:</p>
     <ul>
      <li data-md>
       <p>the `protocol` <a data-link-type="dfn" href="#event-field" id="ref-for-event-field⑧">event field</a> MUST be set to a value of `PREP`,</p>
      <li data-md>
       <p>the `status` <a data-link-type="dfn" href="#event-field" id="ref-for-event-field⑨">event field</a> MUST be set to `412 (Precondition Failed)` (<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-15.5.13">§ 15.5.13 412 Precondition Failed</a>) status code.</p>
     </ul>
   </ul>
   <h3 class="heading settled" data-level="8.3" id="response-with-notification-errors"><span class="secno">8.3. </span><span class="content">Notification Errors</span><a class="self-link" href="#response-with-notification-errors"></a></h3>
   <p>A <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server②⑥">resource server</a> might still not be able to send notifications using the <span class="title">Per Resource Events Protocol</span> requested by an <a data-link-type="dfn" href="#application-client" id="ref-for-application-client①①">application client</a> despite a valid response.</p>
   <p>A <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server②⑦">resource server</a> unable to serve <span class="shortname">PREP</span> notifications, even when the request results in a status code mentioned in <a href="#error-response">§ 8.2 Error Response</a>:</p>
   <ul>
    <li data-md>
     <p>SHOULD include the <span>`<code><a data-link-type="http-header" href="#events-header" id="ref-for-events-header①⑧">Events</a></code>`</span> header fields in the response where:</p>
     <ul>
      <li data-md>
       <p>the `protocol` <a data-link-type="dfn" href="#event-field" id="ref-for-event-field①⓪">event field</a> MUST be set to a value of `PREP`,</p>
      <li data-md>
       <p>the `status` <a data-link-type="dfn" href="#event-field" id="ref-for-event-field①①">event field</a> MUST be set to appropriate  status code indicating the reason for not serving notifications.</p>
     </ul>
   </ul>
   <h2 class="heading settled" data-level="9" id="notifications-response"><span class="secno">9. </span><span class="content">Notifications Response</span><a class="self-link" href="#notifications-response"></a></h2>
   <p></p>
   <h3 class="heading settled" data-level="9.1" id="notifications-response-common-headers"><span class="secno">9.1. </span><span class="content">Common Headers</span><a class="self-link" href="#notifications-response-common-headers"></a></h3>
   <p>A <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server②⑧">resource server</a> providing notifications using the <span class="title">Per Resource Events Protocol</span>:</p>
   <ul>
    <li data-md>
     <p>MUST include the following header fields in the response:</p>
     <ul>
      <li data-md>
       <p>`Date` (<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-6.6.1">§ 6.6.1 Date</a>).</p>
      <li data-md>
       <p>`Content-Type` (<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-8.3">§ 8.3 Content-Type</a>) with the media type set to `multipart` (<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-8.3.3">§ 8.3.3 Multipart Types</a>). The subtype will depend on whether the base response is included in the response body.</p>
      <li data-md>
       <p><span>`<code><a data-link-type="http-header" href="#events-header" id="ref-for-events-header①⑨">Events</a></code>`</span> which MUST include the following <a data-link-type="dfn" href="#event-field" id="ref-for-event-field①②">event fields</a>:</p>
       <ul>
        <li data-md>
         <p>`protocol` set to the value `PREP`.</p>
        <li data-md>
         <p>`status` set to the `200 (OK)` (<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-15.3.1">§ 15.3.1 200 OK</a>) status code.</p>
        <li data-md>
         <p>`expires` with an integer value in seconds indicating an interval after `Date` when notifications will no longer be sent and the response stream is closed.</p>
       </ul>
       <p class="note" role="note"><span class="marker">NOTE:</span> Since caching is meaningless in the context of notifications, this specifications repurposes the deprecated `Expires` header field to specify when the notifications response ends.</p>
     </ul>
     <div class="v-space"></div>
    <li data-md>
     <p>SHOULD include the following header fields in the response:</p>
     <ul>
      <li data-md>
       <p>`Vary` (<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-12.5.5">§ 12.5.5 Vary</a>) which MUST include <span>`<code><a data-link-type="http-header" href="#accept-events-header" id="ref-for-accept-events-header②④">Accept-Events</a></code>`</span> as one of the values.</p>
      <li data-md>
       <p>`Last-Modified` (<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-8.8.2">§ 8.8.2 Last-Modified</a>).</p>
      <li data-md>
       <p>`ETag` (<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-8.8.3">§ 8.8.3 ETag</a>).</p>
     </ul>
     <div class="v-space"></div>
    <li data-md>
     <p>MAY include the following header fields in the response:</p>
     <ul>
      <li data-md>
       <p><span>`<code><a data-link-type="http-header" href="#accept-events-header" id="ref-for-accept-events-header②⑤">Accept-Events</a></code>`</span> which MUST list `PREP` as one of the available notification protocols. Associated with the `PREP` list item, the <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server②⑨">resource server</a>:</p>
       <ul>
        <li data-md>
         <p>MUST include an `accept` <a data-link-type="dfn" href="#event-field" id="ref-for-event-field①③">event field</a> with at least one acceptable media-type for notifications.</p>
       </ul>
     </ul>
   </ul>
   <h3 class="heading settled" data-level="9.2" id="only-notifications-response"><span class="secno">9.2. </span><span class="content">Only Notifications</span><a class="self-link" href="#only-notifications-response"></a></h3>
   <p>An <a data-link-type="dfn" href="#application-client" id="ref-for-application-client①②">application client</a> requesting only notifications using the <span class="title">Per Resource Events Protocol</span> needs to explicitly opt out of receiving the <a data-link-type="dfn" href="#base-response" id="ref-for-base-response③">base response</a> as described in <a href="#request">§ 7 Request</a>.</p>
   <p>A <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server③⓪">resource server</a> MUST NOT send the [<a data-link-type="dfn" href="#base-response" id="ref-for-base-response④">base response</a>], if the request for <span class="shortname">PREP</span> notifications includes the `Last-Event-ID` header field (<a data-link-type="biblio" href="#biblio-eventsource" title="Server-Sent Events">[EVENTSOURCE]</a> <a href="https://html.spec.whatwg.org/multipage/server-sent-events.html#section-9.2.4">§ 9.2.4 The `Last-Event-ID` header</a>) which matches the `Event-ID` of the last event on the resource.</p>
   <h4 class="heading settled" data-level="9.2.1" id="only-notifications-response-headers"><span class="secno">9.2.1. </span><span class="content">Headers</span><a class="self-link" href="#only-notifications-response-headers"></a></h4>
   <p>A <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server③①">resource server</a> that provides only notifications using the <span class="title">Per Resource Events Protocol</span> MUST include the `Vary` header field
(<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-12.5.5">§ 12.5.5 Vary</a>) with `Last-Event-ID` as one of the values.</p>
   <h4 class="heading settled" data-level="9.2.2" id="only-notifications-response-body"><span class="secno">9.2.2. </span><span class="content">Body</span><a class="self-link" href="#only-notifications-response-body"></a></h4>
   <p>A <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server③②">resource server</a> MUST transmit <span class="shortname">PREP</span> notifications as a multipart message body (<a data-link-type="biblio" href="#biblio-rfc2046" title="Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types">[RFC2046]</a> <a href="https://www.rfc-editor.org/rfc/rfc2046#section-5.1">§ 5.1 Multipart Media Type</a>), with a media type of `multipart/digest` (<a data-link-type="biblio" href="#biblio-rfc2046" title="Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types">[RFC2046]</a> <a href="https://www.rfc-editor.org/rfc/rfc2046#section-5.1.5">§ 5.1.5 Digest Subtype</a>) that MAY include zero or more body parts. Each body part of the multipart message body MAY contain at most one notification.</p>
   <div class="example" id="example-bf791a27"><a class="self-link" href="#example-bf791a27"></a> <span class="marker">Response with Notifications Only</span> <prep-http-tabs> <div slot="http"> <pre class="include-code highlight"><c- kr>HTTP</c-><c- o>/</c-><c- m>1.1</c-> <c- m>200</c-> <c- ne>OK</c->
<c- e>Vary</c-><c- o>:</c-> <c- l>Accept-Events, Last-Event-ID</c->
<c- e>Accept-Events</c-><c- o>:</c-> <c- l>PREP; accept=message/rfc822</c->
<c- e>Events</c-><c- o>:</c-> <c- l>protocol=PREP, status=200, vary=accept-encoding</c->
<c- e>Last-Modified</c-><c- o>:</c-> <c- l>Sat, 1 April 2023 10:11:12 GMT</c->
<c- e>Transfer-Encoding</c-><c- o>:</c-> <c- l>chunked</c->
<c- e>ETag</c-><c- o>:</c-> <c- l>1234abcd</c->
<c- e>Content-Type</c-><c- o>:</c-> <c- l>multipart/digest; boundary=next-message</c->

--next-message
Content-Type: message/rfc822

&lt;message>
--next-message-- 
</pre> </div> <div slot="http2"> <pre class="include-code highlight"><c- n>HEADERS</c->
  + <c- n>END_HEADERS</c->
  - <c- n>END_STREAM</c->
    <c- p>:</c-><c- n>status</c-> <c- o>=</c-> <c- mi>304</c->
    <c- n>vary</c-> <c- o>=</c-> <c- n>accept-events</c-><c- p>,</c-> <c- n>last-event-id</c->
    <c- n>accept-events</c-> <c- o>=</c-> <c- n>PREP</c-><c- p>;</c-> <c- n>accept</c-><c- o>=</c-><c- n>message</c->/<c- n>rfc822</c->
    <c- n>events</c-> <c- o>=</c-> <c- n>protocol</c-><c- o>=</c-><c- n>PREP</c-><c- p>,</c-> <c- n>status</c-><c- o>=</c-><c- mi>200</c-><c- p>,</c-> <c- n>vary</c-><c- o>=</c-><c- n>accept-encoding</c->
    <c- n>last-modified</c-> <c- o>=</c-> <c- n>Sat</c-><c- p>,</c-> <c- mi>1</c-> <c- n>April</c-> <c- mi>2023</c-> <c- mi>10</c-><c- p>:</c-><c- mi>11</c-><c- p>:</c-><c- mi>12</c-> <c- n>GMT</c->
    <c- n>etag</c-> <c- o>=</c-> <c- mi>1234</c-><c- n>abcd</c->
    <c- n>content-type</c-> <c- o>=</c-> <c- n>multipart</c->/<c- n>digest</c-><c- p>;</c-> <c- n>boundary</c-><c- o>=</c-><c- n>next-message</c->

<c- n>DATA</c->
  - <c- n>END_STREAM</c->
--<c- n>next-message</c->

<c- n>DATA</c->
  - <c- n>END_STREAM</c->
<c- n>content-type</c-> <c- o>=</c-> <c- n>message</c->/<c- n>rfc822</c->
<c- n>CRLF</c->&lt;<c- n>message</c->>
--<c- n>next-message</c->

<c- n>DATA</c->
  + <c- n>END_STREAM</c->
--<c- n>next-message--</c-> 
</pre> </div> </prep-http-tabs> </div>
   <div class="advisement">
    <div class="marker">Implementation Guidance</div>
    <p>While not strictly necessary, it is strongly encouraged that <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server③③">resource servers</a> send notifications in a manner such that the boundary delimiter (<a data-link-type="biblio" href="#biblio-rfc2046" title="Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types">[RFC2046]</a> <a href="https://www.rfc-editor.org/rfc/rfc2046#section-5.1.2">§ 5.1 Multipart Media Type > § 5.1.2 Common Syntax</a>) is always at the end of a chunk (<a data-link-type="biblio" href="#biblio-rfc9112" title="HTTP/1.1">[RFC9112]</a> <a href="https://www.rfc-editor.org/rfc/rfc9112#section-7.1">§ 7.1 Chunked Transfer Coding</a>) or data frame (<a data-link-type="biblio" href="#biblio-rfc9113" title="HTTP/2">[RFC9113]</a> <a href="https://www.rfc-editor.org/rfc/rfc9113#section-6.1">§ 6 Frame Definitions > § 6.1 DATA</a>) as shown in the example above. This way an <a data-link-type="dfn" href="#application-client" id="ref-for-application-client①③">application  client</a> does not have to wait until the next chunk or frame (which might be a while or in cases of error never arrive) to be certain that the immediate message is complete.</p>
   </div>
   <h3 class="heading settled" data-level="9.3" id="composite-response"><span class="secno">9.3. </span><span class="content">Composite Response</span><a class="self-link" href="#composite-response"></a></h3>
   <p>By default, the <span class="title">Per Resource Events Protocol</span> requires a <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server③④">resource server</a> to transmit the <a data-link-type="dfn" href="#base-response" id="ref-for-base-response⑤">base response</a> body before notifications. An <a data-link-type="dfn" href="#application-client" id="ref-for-application-client①④">application client</a> MAY opt out of this behaviour as described in <a href="#request">§ 7 Request</a>.</p>
   <p class="note" role="note"><span class="marker">NOTE:</span> Not only does this behaviour ensure interoperability, it is also desirable in most scenarios. It short-circuits an extra round trip that would be otherwise needed to fetch the current representation before notifications and eliminates the need to co-ordinate the two responses.</p>
   <h4 class="heading settled" data-level="9.3.1" id="composite-response-headers"><span class="secno">9.3.1. </span><span class="content">Headers</span><a class="self-link" href="#composite-response-headers"></a></h4>
   <p>If the request for <span class="shortname">PREP</span> notifications includes the `Last-Event-ID` header field, a <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server③⑤">resource server</a> MUST include `Vary` header field
(<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-12.5.5">§ 12.5.5 Vary</a>) with `last-event-id` as one of the values.</p>
   <h4 class="heading settled" data-level="9.3.2" id="composite-response-body"><span class="secno">9.3.2. </span><span class="content">Body</span><a class="self-link" href="#composite-response-body"></a></h4>
   <p>Where the response includes a <a data-link-type="dfn" href="#base-response" id="ref-for-base-response⑥">base response</a> body prior to <span class="shortname">PREP</span> notifications, a <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server③⑥">resource server</a> MUST transmit a multipart message body (<a data-link-type="biblio" href="#biblio-rfc2046" title="Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types">[RFC2046]</a> <a href="https://www.rfc-editor.org/rfc/rfc2046#section-5.1">§ 5.1 Multipart Media Type</a>) with a media type of `multipart/mixed` (<a data-link-type="biblio" href="#biblio-rfc2046" title="Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types">[RFC2046]</a> <a href="https://www.rfc-editor.org/rfc/rfc2046#section-5.1.3">§ 5.1.3 Mixed Subtype</a>) with two body parts in the order specified below:</p>
   <ol>
    <li data-md>
     <p>the message body that would have been sent had notifications not been requested.</p>
    <li data-md>
     <p>the multipart response body with body parts containing notifications as defined in <a href="#only-notifications-response">§ 9.2 Only Notifications</a>.</p>
   </ol>
   <div class="example" id="example-380e3fe0"><a class="self-link" href="#example-380e3fe0"></a> <span class="marker">Full Response</span> <prep-http-tabs> <div slot="http"> <pre class="include-code highlight"><c- kr>HTTP</c-><c- o>/</c-><c- m>1.1</c-> <c- m>200</c-> <c- ne>OK</c->
<c- e>Vary</c-><c- o>:</c-> <c- l>Accept-Events</c->
<c- e>Accept-Events</c-><c- o>:</c-> <c- l>PREP; accept=message/rfc822</c->
<c- e>Events</c-><c- o>:</c-> <c- l>protocol=PREP, status=200, vary=accept-encoding</c->
<c- e>Last-Modified</c-><c- o>:</c-> <c- l>Sat, 1 April 2023 10:11:12 GMT</c->
<c- e>Transfer-Encoding</c-><c- o>:</c-> <c- l>chunked</c->
<c- e>ETag</c-><c- o>:</c-> <c- l>1234abcd</c->
<c- e>Content-Type</c-><c- o>:</c-> <c- l>multipart/mixed; boundary=main-boundary</c->

--main-boundary
<c- f>Content-Type:</c-> <c- nl>text</c->/<c- nl>html</c->
CRLF
&lt;html>
--main-boundary
<c- f>Content-Type:</c-> <c- nl>multipart</c->/<c- nl>digest</c->; <c- e>boundary</c-><c- o>=</c-><c- s>next-message</c->

--next-message
Content-Type: message/rfc822

&lt;message>
--next-message-- 
--main-boundary-- 
</pre> </div> <div slot="http2"> <pre class="include-code highlight"><c- n>HEADERS</c->
  + <c- n>END_HEADERS</c->
  - <c- n>END_STREAM</c->
    <c- p>:</c-><c- n>status</c-> <c- o>=</c-> <c- mi>304</c->
    <c- n>vary</c-> <c- o>=</c-> <c- n>accept-events</c->
    <c- n>accept-events</c-> <c- o>=</c-> <c- n>PREP</c-><c- p>;</c-> <c- n>accept</c-><c- o>=</c-><c- n>message</c->/<c- n>rfc822</c->
    <c- n>events</c-> <c- o>=</c-> <c- n>protocol</c-><c- o>=</c-><c- n>PREP</c-><c- p>,</c-> <c- n>status</c-><c- o>=</c-><c- mi>200</c-><c- p>,</c-> <c- n>vary</c-><c- o>=</c-><c- n>accept-encoding</c->
    <c- n>last-modified</c-> <c- o>=</c-> <c- n>Sat</c-><c- p>,</c-> <c- mi>1</c-> <c- n>April</c-> <c- mi>2023</c-> <c- mi>10</c-><c- p>:</c-><c- mi>11</c-><c- p>:</c-><c- mi>12</c-> <c- n>GMT</c->
    <c- n>etag</c-> <c- o>=</c-> <c- mi>1234</c-><c- n>abcd</c->
    <c- n>content-type</c-> <c- o>=</c-> <c- n>multipart</c->/<c- n>mixed</c-><c- p>;</c-> <c- n>boundary</c-><c- o>=</c-><c- n>main-boundary</c->

<c- n>DATA</c->
  - <c- n>END</c-> <c- n>STREAM</c->
--<c- n>main-boundary</c->
<c- n>Content-Type</c-><c- p>:</c-> <c- n>text</c->/<c- n>html</c->
<c- n>CRLF</c->
&lt;<c- n>html</c->>
--<c- n>main-boundary</c->

<c- n>DATA</c->
  - <c- n>END</c-> <c- n>STREAM</c->
<c- n>Content-Type</c-><c- p>:</c-> <c- n>multipart</c->/<c- n>digest</c-><c- p>;</c-> <c- n>boundary</c-><c- o>=</c-><c- n>next-message</c->
<c- n>CRLF</c->
--<c- n>next-message</c->

<c- n>DATA</c->
  - <c- n>END</c-> <c- n>STREAM</c->
<c- n>Content-Type</c-><c- p>:</c-> <c- n>message</c->/<c- n>rfc822</c->
<c- n>CRLF</c->&lt;<c- n>message</c->>
--<c- n>next-message</c->

<c- n>DATA</c->
  + <c- n>END</c-> <c- n>STREAM</c->
--<c- n>next-message--</c->
--<c- n>main-boundary--</c-> 
</pre> </div> </prep-http-tabs> </div>
   <h3 class="heading settled" data-level="9.4" id="notifications-response-termination"><span class="secno">9.4. </span><span class="content">Termination</span><a class="self-link" href="#notifications-response-termination"></a></h3>
   <p>A <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server③⑦">resource server</a> MUST end the notification response in any one of the following scenarios:</p>
   <ul>
    <li data-md>
     <p>Once the time specified in the `expires` parameter of the `Events` header field has elapsed.</p>
    <li data-md>
     <p>Immediately after sending a notification upon a `DELETE` request on the resource that results in a response with 200 (OK) (<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-15.3.1">§ 15.3.1 200 OK</a>) or 204 (No Content) (<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-15.3.5">§ 15.3.5 204 No Content</a>) status codes.</p>
   </ul>
   <p>A <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server③⑧">resource server</a> MUST properly terminate the multipart response as defined in <a data-link-type="biblio" href="#biblio-rfc2046" title="Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types">[RFC2046]</a> <a href="https://www.rfc-editor.org/rfc/rfc2046#section-5.1.2">§ 5.1 Multipart Media Type > § 5.1.2 Common Syntax</a>, before closing the notification response stream.</p>
   <div class="advisement">
    <div class="marker">Implementation Guidance</div>
    <p>When a user navigates away from a website or an application using PREP notifications, <a data-link-type="dfn" href="#application-client" id="ref-for-application-client①⑤">application clients</a> are strongly encouraged to properly close the response stream to ensure that servers do not keep sending notifications.</p>
   </div>
   <h2 class="heading settled" id="rfc822-for-notifications"><span class="content"> Appendix A: Additional Semantics for `message/rfc822` </span><a class="self-link" href="#rfc822-for-notifications"></a></h2>
   <p>The `multipart/digest` multipart media-type (<a data-link-type="biblio" href="#biblio-rfc2046" title="Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types">[RFC2046]</a> <a href="https://www.rfc-editor.org/rfc/rfc2046#section-5.1.5">§ 5.1.5 Digest Subtype</a>) uses `message/rfc822` media-type (<a data-link-type="biblio" href="#biblio-rfc2046" title="Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types">[RFC2046]</a> <a href="https://www.rfc-editor.org/rfc/rfc2046#section-5.2.1">§ 5.2.1 RFC822 Subtype</a>, <a data-link-type="biblio" href="#biblio-rfc822" title="Internet Message Format">[RFC822]</a>) for body parts as default. It follows that the <span class="title">Per Resource Events Protocol</span> transmits notifications as `message/rfc822`, unless the <a data-link-type="dfn" href="#application-client" id="ref-for-application-client①⑥">application client</a> requests otherwise.</p>
   <h3 class="heading settled" id="rfc822-request"><span class="content">Request</span><a class="self-link" href="#rfc822-request"></a></h3>
   <p>An <a data-link-type="dfn" href="#application-client" id="ref-for-application-client①⑦">application clients</a> MAY specify additional parameters to `message/rfc822` notification media-type in the `accept` <a data-link-type="dfn" href="#event-field" id="ref-for-event-field①④">event field</a> associated with the `PREP` list item in the <span>`<code><a data-link-type="http-header" href="#accept-events-header" id="ref-for-accept-events-header②⑥">accept-events</a></code>`</span> header field of the request.</p>
   <h3 class="heading settled" id="rfc822-generation"><span class="content">Generation</span><a class="self-link" href="#rfc822-generation"></a></h3>
   <p>A <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server③⑨">resource server</a> implementing the <span class="title">Per Resource Events Protocol</span> SHOULD send a notification to an <a data-link-type="dfn" href="#application-client" id="ref-for-application-client①⑧">application client</a> when a request with one of the following methods on a resource:</p>
   <ul>
    <li data-md>
     <p>`POST` (<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-9.3.3">§ 9.3.3 POST</a>),</p>
    <li data-md>
     <p>`PUT` (<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-9.3.4">§ 9.3.4 PUT</a>),</p>
    <li data-md>
     <p>`PATCH` (<a data-link-type="biblio" href="#biblio-rfc5789" title="PATCH Method for HTTP">[RFC5789]</a>),</p>
    <li data-md>
     <p>`DELETE` (<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-9.3.5">§.3.5 DELETE</a>).</p>
   </ul>
   <p>generates one of the following status codes:</p>
   <ul>
    <li data-md>
     <p>`200 (OK)` (<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-15.3.1">§ 15.3.1 200 OK</a>)</p>
    <li data-md>
     <p>`201 (Created)` (<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-15.3.2">§ 15.3.2 201 Created</a>):</p>
    <li data-md>
     <p>`204 (No Content)` (<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-15.3.5">§ 15.3.5 204 No Content</a>)</p>
   </ul>
   <p>The notification MUST NOT be sent before the success response has been sent to the user agent that initiated the request.</p>
   <h3 class="heading settled" id="rfc822-headers"><span class="content">Headers</span><a class="self-link" href="#rfc822-headers"></a></h3>
   <p>A <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server④⓪">resource server</a> MUST include the following header fields in a `message/rfc822` formatted <span class="shortname">PREP</span> notification:</p>
   <dl>
    <dt data-md>`Method`
    <dd data-md>
     <p>identical to `:method` pseudo-header field in a HTTP/2 request (<a data-link-type="biblio" href="#biblio-rfc9113" title="HTTP/2">[RFC9113]</a> <a href="https://www.rfc-editor.org/rfc/rfc9113#section-8.3.1">§ 8.3.1 Request Pseudo-Header Fields</a>), that specifies the request method that triggered the notification.</p>
    <dt data-md>`Date`
    <dd data-md>
     <p>identical to `Date` header field in a HTTP response (<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-6.6.1">§ 6.6.1 Date</a>), that specifies date and time at which the event that triggered the notification was completed.</p>
    <dt data-md>`Event-ID`
    <dd data-md>
     <p>an opaque identifier for the generated notification.</p>
     <div class="issue" id="issue-d779274b">
      <a class="self-link" href="#issue-d779274b"></a> 
      <p>Do we need to make this identical to one of the following:</p>
      <ul>
       <li data-md>
        <p>`Message-ID` (<a href="https://www.rfc-editor.org/rfc/rfc5322#section-3.6.4">Internet Message Format § section-3.6.4</a>),</p>
       <li data-md>
        <p>`id` (<a href="https://html.spec.whatwg.org/multipage/server-sent-events.html#section-9.2.6">Server-Sent Events § section-9.2.6</a>).</p>
      </ul>
     </div>
   </dl>
   <p>A <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server④①">resource server</a> SHOULD include the following headers in a `message/rfc822` formatted <span class="shortname">PREP</span> notification when the state of the resource or its representation is modified as a result of the event:</p>
   <dl>
    <dt data-md>`ETag`
    <dd data-md>
     <p>identical to `ETag` header field (<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-8.8.3">§ 8.8.3 ETag</a>) in a HTTP response, that is an opaque identifier for the current representation of the state of the resource.</p>
   </dl>
   <div class="example" id="example-fccabc59">
    <a class="self-link" href="#example-fccabc59"></a> 
    <p><cite>`PUT` notification message</cite></p>
<pre class="language-http highlight">Method: PUT
Date: Sat, 1 April 2023 10:11:12 GMT
Event-ID: 1234
ETag: "abc123"
--random-boundary
</pre>
   </div>
   <p>A <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server④②">resource server</a> MUST include the following headers in a `message/rfc822` formatted <span class="shortname">PREP</span> notification when sent as a result of a `POST` request that modifies another resource:</p>
   <dl>
    <dt data-md>`Content-Location`
    <dd data-md>
     <p>identical to the `Content-Location` header field (<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-8.7">§ 8.7 Content-Location</a>).</p>
   </dl>
   <div class="example" id="example-29d5a56e">
    <a class="self-link" href="#example-29d5a56e"></a> 
    <p><cite>`POST` notification message:</cite></p>
<pre class="language-http highlight">Method: POST
Date: Sat, 1 April 2023 10:12:14 GMT
Event-ID: 1235
Content-Location: /foo
--random-boundary
</pre>
   </div>
   <h3 class="heading settled" id="rfc822-body"><span class="content">Body</span><a class="self-link" href="#rfc822-body"></a></h3>
   <p>The body of a `message/rfc822` formatted <span class="shortname">PREP</span> notification might be used to provide a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="delta-representation">delta representation</dfn>, the difference between the state of the representation before and after the most recent event on the resource.</p>
   <p>If the <a data-link-type="dfn" href="#application-client" id="ref-for-application-client①⑨">application client</a> does not specify <dfn class="dfn-paneled" data-dfn-type="http-header" data-export id="http-headerdef-delta">delta</dfn> parameter associated with a preferred notifications format of `message/rfc822` in the `accept` <a data-link-type="dfn" href="#event-field" id="ref-for-event-field①⑤">event field</a> of the <a href="#request">§ 7 Request</a> that results in `message/rfc822` formatted <span class="shortname">PREP</span> notifications, the notifications MUST NOT contain a body.</p>
   <p>If the <a data-link-type="dfn" href="#application-client" id="ref-for-application-client②⓪">application client</a> specifies a (<span>`<code><a data-link-type="http-header" href="#http-headerdef-delta" id="ref-for-http-headerdef-delta">delta</a></code>`</span>) parameter associated with a preferred notifications format of `message/rfc822` in the `accept` <a data-link-type="dfn" href="#event-field" id="ref-for-event-field①⑥">event field</a> of the <a href="#request">§ 7 Request</a> that results in `message/rfc822` formatted <span class="shortname">PREP</span> notifications, a <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server④③">resource server</a> SHOULD send the <a data-link-type="dfn" href="#delta-representation" id="ref-for-delta-representation">delta representation</a> as the body of the notification when a request with one of the following methods on a resource:</p>
   <ul>
    <li data-md>
     <p>`POST` (<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-9.3.3">§ 9.3.3 POST</a>),</p>
    <li data-md>
     <p>`PUT` (<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-9.3.4">§ 9.3.4 PUT</a>),</p>
    <li data-md>
     <p>`PATCH` (<a data-link-type="biblio" href="#biblio-rfc5789" title="PATCH Method for HTTP">[RFC5789]</a>),</p>
   </ul>
   <p>generate one of the following status codes:</p>
   <ul>
    <li data-md>
     <p>`200 (OK)` (<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-15.3.1">§ 15.3.1 200 OK</a>),</p>
    <li data-md>
     <p>`201 (Created)` (<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-15.3.2">§ 15.3.2 201 Created</a>),</p>
    <li data-md>
     <p>`204 (No Content)` (<a data-link-type="biblio" href="#biblio-rfc9110" title="HTTP Semantics">[RFC9110]</a> <a href="https://www.rfc-editor.org/rfc/rfc9110#section-15.3.5">§ 15.3.5 204 No Content</a>).</p>
   </ul>
   <p>A <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server④④">resource server</a> SHOULD send the <a data-link-type="dfn" href="#delta-representation" id="ref-for-delta-representation①">delta representation</a> in the content-type preferred by the client as specified by the <span>`<code><a data-link-type="http-header" href="#http-headerdef-delta" id="ref-for-http-headerdef-delta①">delta</a></code>`</span> parameter.</p>
   <p></p>
   <div class="example" id="example-08349e2f">
    <a class="self-link" href="#example-08349e2f"></a> 
    <p><cite>`PATCH` notification with delta representation:</cite></p>
<pre class="language-http highlight">--random-boundary  &lt;- From the Previous Message
                   &lt;- Empty part response headers &amp; a blank line
Method: PATCH
Date: Sat, 1 April 2023 10:14:16 GMT
Event-ID: 1236
ETag: "xyz987"
Content-type: application/example
&lt;delta>
--random-boundary
</pre>
   </div>
   <h2 class="no-num heading settled" id="considerations"><span class="content"> Considerations </span><a class="self-link" href="#considerations"></a></h2>
   <p>This section details security and privacy considerations.</p>
   <p>Some of the normative references within this specification point to documents with a Living Standard or Draft status, meaning their contents can still change over time. It is advised to monitor these documents, as such changes might have implications.</p>
   <h3 class="heading settled" id="security-considerations"><span class="content">Security Considerations</span><a class="self-link" href="#security-considerations"></a></h3>
   <p><em>This section is non-normative.</em></p>
   <p><a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server④⑤">Resource servers</a> are strongly discouraged from exposing information beyond the minimum amount necessary to enable a feature. <a data-link-type="dfn" href="#application-client" id="ref-for-application-client②①">Application clients</a> are strongly discouraged from exposing information beyond the minimum amount necessary to receive updates about particular resources.</p>
   <p><a data-link-type="dfn" href="#application-client" id="ref-for-application-client②②">Application clients</a> are discouraged from sending requests for notifications to untrusted <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server④⑥">resource servers</a>, including localhost or any other loopback IP address, in order to avoid making arbitrary requests.</p>
   <h3 class="heading settled" id="privacy-considerations"><span class="content">Privacy Considerations</span><a class="self-link" href="#privacy-considerations"></a></h3>
   <p><em>This section is non-normative.</em></p>
   <h3 class="heading settled" id="security-and-privacy-review"><span class="content">Security and Privacy Review</span><a class="self-link" href="#security-and-privacy-review"></a></h3>
   <p><em>This section is non-normative.</em></p>
   <p>These questions provide an overview of security and privacy considerations for this specification as guided by <a data-link-type="biblio" href="#biblio-security-privacy-questionnaire" title="Self-Review Questionnaire: Security and Privacy">[SECURITY-PRIVACY-QUESTIONNAIRE]</a>.</p>
   <dl>
    <dt data-md><a href="https://www.w3.org/TR/security-privacy-questionnaire/#purpose">What information might this feature expose to Web sites or other parties, and for what purposes is that exposure necessary?</a>
    <dd data-md>
     <p>There are no known security impacts of the features in this specification.</p>
    <dt data-md><a href="https://www.w3.org/TR/security-privacy-questionnaire/#minimum-data">Do features in your specification expose the minimum amount of information necessary to enable their intended uses?</a>
    <dd data-md>
     <p>Yes.</p>
    <dt data-md><a href="https://www.w3.org/TR/security-privacy-questionnaire/#personal-data">How do the features in your specification deal with personal information, personally-identifiable information (PII), or information derived from them?</a>
    <dd data-md>
     <p>Access to <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server④⑦">resource server</a> is only granted to authorized access subjects. Notification payloads can contain any data (including that which identifies or refers to agents that control the <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server④⑧">resource server</a>). Meaningful consent to any personal data that <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server④⑨">resource servers</a> include about agents associated with themselves or resources of interest are extended to the <a data-link-type="dfn" href="#application-client" id="ref-for-application-client②③">application client</a>. <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server⑤⓪">Resource servers</a> are discouraged from exposing information beyond the amount necessary to enable or use a feature.</p>
    <dt data-md><a href="https://www.w3.org/TR/security-privacy-questionnaire/#sensitive-data">How do the features in your specification deal with sensitive information?</a>
    <dd data-md>
     <p>The features do not require sensitive information to be obtained or exposed.</p>
    <dt data-md><a href="https://www.w3.org/TR/security-privacy-questionnaire/#persistent-origin-specific-state">Do the features in your specification introduce new state for an origin that persists across browsing sessions?</a>
    <dd data-md>
     <p>No.</p>
    <dt data-md><a href="https://www.w3.org/TR/security-privacy-questionnaire/#underlying-platform-data">Do the features in your specification expose information about the underlying platform to origins?</a>
    <dd data-md>
     <p>No.</p>
    <dt data-md><a href="https://www.w3.org/TR/security-privacy-questionnaire/#send-to-platform">Does this specification allow an origin to send data to the underlying platform?</a>
    <dd data-md>
     <p>No. Resources are described within the framework of HTTP. A <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server⑤①">resource server</a> might be able to redirect to other resources, (e.g., the https: URLs to file:, data:, or blob: URLs), but no such behaviour is defined by this specification.</p>
    <dt data-md><a href="https://www.w3.org/TR/security-privacy-questionnaire/#sensor-data">Do features in this specification allow an origin access to sensors on a user’s device</a>
    <dd data-md>
     <p>No.</p>
    <dt data-md><a href="https://www.w3.org/TR/security-privacy-questionnaire/#other-data">What data do the features in this specification expose to an origin? Please also document what data is identical to data exposed by other features, in the same or different contexts.</a>
    <dd data-md>
     <p>No detail about another origin’s state is exposed. When <a data-link-type="dfn" href="#resource-server" id="ref-for-resource-server⑤②">resource servers</a> participate in the CORS protocol <a data-link-type="biblio" href="#biblio-fetch" title="Fetch Standard">[FETCH]</a>, HTTP requests from different origins might be allowed. This feature does not add any new attack surface above and beyond normal CORS requests, so no extra mitigation is deemed necessary.</p>
    <dt data-md><a href="https://www.w3.org/TR/security-privacy-questionnaire/#string-to-script">Do features in this specification enable new script execution/loading mechanisms?</a>
    <dd data-md>
     <p>No.</p>
    <dt data-md><a href="https://www.w3.org/TR/security-privacy-questionnaire/#remote-device">Do features in this specification allow an origin to access other devices?</a>
    <dd data-md>
     <p>No.</p>
    <dt data-md><a href="https://www.w3.org/TR/security-privacy-questionnaire/#native-ui">Do features in this specification allow an origin some measure of control over a user agent’s native UI?</a>
    <dd data-md>
     <p>No.</p>
    <dt data-md><a href="https://www.w3.org/TR/security-privacy-questionnaire/#temporary-id">What temporary identifiers do the features in this specification create or expose to the web?</a>
    <dd data-md>
     <p>No.</p>
    <dt data-md><a href="https://www.w3.org/TR/security-privacy-questionnaire/#first-third-party">How does this specification distinguish between behaviour in first-party and third-party contexts?</a>
    <dd data-md>
     <p>Not Applicable.</p>
    <dt data-md><a href="https://www.w3.org/TR/security-privacy-questionnaire/#private-browsing">How do the features in this specification work in the context of a browser’s Private Browsing or Incognito mode?</a>
    <dd data-md>
     <p>No different than in the browser’s "normal" state.</p>
    <dt data-md><a href="https://www.w3.org/TR/security-privacy-questionnaire/#considerations">Does this specification have both "Security Considerations" and "Privacy Considerations" sections?</a>
    <dd data-md>
     <p>Yes, in <a href="#security-considerations">Security Considerations</a> and <a href="#privacy-considerations">Privacy Considerations</a>.</p>
    <dt data-md><a href="https://www.w3.org/TR/security-privacy-questionnaire/#relaxed-sop">Do features in your specification enable origins to downgrade default security protections?</a>
    <dd data-md>
     <p>No.</p>
    <dt data-md><a href="https://www.w3.org/TR/security-privacy-questionnaire/#non-fully-active">How does your feature handle non-"fully active" documents?</a>
    <dd data-md>
     <p>Not Applicable.</p>
   </dl>
<script type="module">
/* eslint-disable import/no-extraneous-dependencies,import/no-unresolved */
import 'https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.1.0/dist/components/tab/tab.js'
import 'https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.1.0/dist/components/tab-group/tab-group.js'
import 'https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.1.0/dist/components/tab-panel/tab-panel.js'
// import { setBasePath } from 'https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.1.0/dist/utilities/base-path.js'
import { html, css, LitElement } from 'https://unpkg.com/lit?module'

// setBasePath('https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.1.0/dist/')

customElements.define('prep-http-tabs', class extends LitElement {
  firstUpdated() {
    requestAnimationFrame(() => {
      this.renderRoot.querySelector('sl-tab-group').show('http2')
    })
  }

  static styles = css`
    sl-tab-panel::part(base) {
      padding: 0;
    }
  `

  render() {
    return html`
      <sl-tab-group>
        <sl-tab slot="nav" panel="http">
          HTTP/1.1
        </sl-tab>
        <sl-tab slot="nav" panel="http2" active>
          HTTP/2
        </sl-tab>

        <sl-tab-panel name="http">
          <slot name="http"></slot>
        </sl-tab-panel>

        <sl-tab-panel name="http2">
          <slot name="http2"></slot>
        </sl-tab-panel>
      </sl-tab-group>
    `
  }
})
</script>
  </main>
<script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-eventsource">[EVENTSOURCE]
   <dd>Ian Hickson. <a href="https://html.spec.whatwg.org/multipage/server-sent-events.html"><cite>Server-Sent Events</cite></a>. URL: <a href="https://html.spec.whatwg.org/multipage/server-sent-events.html">https://html.spec.whatwg.org/multipage/server-sent-events.html</a>
   <dt id="biblio-fetch">[FETCH]
   <dd>Anne van Kesteren. <a href="https://fetch.spec.whatwg.org/"><cite>Fetch Standard</cite></a>. Living Standard. URL: <a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
   <dt id="biblio-retrofit-fields">[RETROFIT-FIELDS]
   <dd>Mark Nottingham. <a href="https://datatracker.ietf.org/doc/draft-ietf-httpbis-retrofit/06/"><cite>Retrofit Structured Fields for HTTP</cite></a>. Internet Draft. URL: <a href="https://datatracker.ietf.org/doc/draft-ietf-httpbis-retrofit/06/">https://datatracker.ietf.org/doc/draft-ietf-httpbis-retrofit/06/</a>
   <dt id="biblio-rfc2046">[RFC2046]
   <dd>N. Freed; N. Borenstein. <a href="https://www.rfc-editor.org/rfc/rfc2046"><cite>Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types</cite></a>. November 1996. Draft Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc2046">https://www.rfc-editor.org/rfc/rfc2046</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
   <dt id="biblio-rfc3229">[RFC3229]
   <dd>J. Mogul; et al. <a href="https://www.rfc-editor.org/rfc/rfc3229"><cite>Delta encoding in HTTP</cite></a>. January 2002. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc3229">https://www.rfc-editor.org/rfc/rfc3229</a>
   <dt id="biblio-rfc5789">[RFC5789]
   <dd>L. Dusseault; J. Snell. <a href="https://httpwg.org/specs/rfc5789.html"><cite>PATCH Method for HTTP</cite></a>. March 2010. Proposed Standard. URL: <a href="https://httpwg.org/specs/rfc5789.html">https://httpwg.org/specs/rfc5789.html</a>
   <dt id="biblio-rfc8174">[RFC8174]
   <dd>B. Leiba. <a href="https://www.rfc-editor.org/rfc/rfc8174"><cite>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</cite></a>. May 2017. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>
   <dt id="biblio-rfc822">[RFC822]
   <dd>P. Resnick, Ed.. <a href="https://www.rfc-editor.org/rfc/rfc5322"><cite>Internet Message Format</cite></a>. October 2008. Draft Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc5322">https://www.rfc-editor.org/rfc/rfc5322</a>
   <dt id="biblio-rfc9110">[RFC9110]
   <dd>R. Fielding, Ed.; M. Nottingham, Ed.; J. Reschke, Ed.. <a href="https://www.rfc-editor.org/rfc/rfc9110"><cite>HTTP Semantics</cite></a>. June 2022. Internet Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc9110">https://www.rfc-editor.org/rfc/rfc9110</a>
   <dt id="biblio-rfc9112">[RFC9112]
   <dd>R. Fielding, Ed.; M. Nottingham, Ed.; J. Reschke, Ed.. <a href="https://www.rfc-editor.org/rfc/rfc9112"><cite>HTTP/1.1</cite></a>. June 2022. Internet Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc9112">https://www.rfc-editor.org/rfc/rfc9112</a>
   <dt id="biblio-rfc9113">[RFC9113]
   <dd>M. Thomson, Ed.; C. Benfield, Ed.. <a href="https://www.rfc-editor.org/rfc/rfc9113"><cite>HTTP/2</cite></a>. June 2022. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc9113">https://www.rfc-editor.org/rfc/rfc9113</a>
   <dt id="biblio-structured-fields">[STRUCTURED-FIELDS]
   <dd>Mark Nottingham; Poul-Henning Kamp. <a href="https://datatracker.ietf.org/doc/draft-ietf-httpbis-sfbis/03/"><cite>Structured Field Values for HTTP</cite></a>. Internet Draft. URL: <a href="https://datatracker.ietf.org/doc/draft-ietf-httpbis-sfbis/03/">https://datatracker.ietf.org/doc/draft-ietf-httpbis-sfbis/03/</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-rest">[REST]
   <dd>Roy Thomas Fielding. <a href="https://www.ics.uci.edu/~fielding/pubs/dissertation/rest_arch_style.htm"><cite>Architectural styles and the design of network-based software architectures</cite></a>. 2000. URL: <a href="https://www.ics.uci.edu/~fielding/pubs/dissertation/rest_arch_style.htm">https://www.ics.uci.edu/~fielding/pubs/dissertation/rest_arch_style.htm</a>
   <dt id="biblio-rfc7838">[RFC7838]
   <dd>M. Nottingham; P. McManus; J. Reschke. <a href="https://httpwg.org/specs/rfc7838.html"><cite>HTTP Alternative Services</cite></a>. April 2016. Proposed Standard. URL: <a href="https://httpwg.org/specs/rfc7838.html">https://httpwg.org/specs/rfc7838.html</a>
   <dt id="biblio-rfc9205">[RFC9205]
   <dd>M. Nottingham. <a href="https://www.rfc-editor.org/rfc/rfc9205"><cite>Building Protocols with HTTP</cite></a>. June 2022. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc9205">https://www.rfc-editor.org/rfc/rfc9205</a>
   <dt id="biblio-security-privacy-questionnaire">[SECURITY-PRIVACY-QUESTIONNAIRE]
   <dd>Theresa O'Connor; Peter Snyder. <a href="https://w3ctag.github.io/security-questionnaire/"><cite>Self-Review Questionnaire: Security and Privacy</cite></a>. URL: <a href="https://w3ctag.github.io/security-questionnaire/">https://w3ctag.github.io/security-questionnaire/</a>
   <dt id="biblio-websockets">[WEBSOCKETS]
   <dd>Adam Rice. <a href="https://websockets.spec.whatwg.org/"><cite>WebSockets Standard</cite></a>. Living Standard. URL: <a href="https://websockets.spec.whatwg.org/">https://websockets.spec.whatwg.org/</a>
   <dt id="biblio-websub">[WEBSUB]
   <dd>Julien Genestoux; Aaron Parecki. <a href="https://websub.net/draft"><cite>WebSub</cite></a>. URL: <a href="https://websub.net/draft">https://websub.net/draft</a>
  </dl>
<script>/* Boilerplate: script-dfn-panel */
"use strict";
{
    const dfnsJson = window.dfnsJson || {};

    function genDfnPanel({dfnID, url, dfnText, refSections, external}) {
        return mk.aside({
            class: "dfn-panel",
            id: `infopanel-for-${dfnID}`,
            "data-for": dfnID,
            "aria-labelled-by":`infopaneltitle-for-${dfnID}`,
            },
            mk.span({id:`infopaneltitle-for-${dfnID}`, style:"display:none"},
                `Info about the '${dfnText}' ${external?"external":""} reference.`),
            mk.a({href:url}, url),
            mk.b({}, "Referenced in:"),
            mk.ul({},
                ...refSections.map(section=>
                    mk.li({},
                        ...section.refs.map((ref, refI)=>
                            [
                                mk.a({
                                    href: `#${ref.id}`
                                    },
                                    (refI == 0) ? section.title : `(${refI + 1})`
                                ),
                                " ",
                            ]
                        ),
                    ),
                ),
            ),
        );
    }

    function genAllDfnPanels() {
        for(const panelData of Object.values(window.dfnpanelData)) {
            const dfnID = panelData.dfnID;
            const dfn = document.getElementById(dfnID);
            if(!dfn) {
                console.log(`Can't find dfn#${dfnID}.`, panelData);
            } else {
                const panel = genDfnPanel(panelData);
                append(document.body, panel);
                insertDfnPopupAction(dfn, panel)
            }
        }
    }

    document.addEventListener("DOMContentLoaded", ()=>{
        genAllDfnPanels();

        // Add popup behavior to all dfns to show the corresponding dfn-panel.
        var dfns = queryAll('.dfn-paneled');
        for(let dfn of dfns) { ; }

        document.body.addEventListener("click", (e) => {
            // If not handled already, just hide all dfn panels.
            hideAllDfnPanels();
        });
    })


    function hideAllDfnPanels() {
        // Turn off any currently "on" or "activated" panels.
        queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el=>hideDfnPanel(el));
    }

    function showDfnPanel(dfnPanel, dfn) {
        hideAllDfnPanels(); // Only display one at this time.
        dfn.setAttribute("aria-expanded", "true");
        dfnPanel.classList.add("on");
        dfnPanel.style.left = "5px";
        dfnPanel.style.top = "0px";
        const panelRect = dfnPanel.getBoundingClientRect();
        const panelWidth = panelRect.right - panelRect.left;
        if (panelRect.right > document.body.scrollWidth) {
            // Panel's overflowing the screen.
            // Just drop it below the dfn and flip it rightward instead.
            // This still wont' fix things if the screen is *really* wide,
            // but fixing that's a lot harder without 'anchor()'.
            dfnPanel.style.top = "1.5em";
            dfnPanel.style.left = "auto";
            dfnPanel.style.right = "0px";
        }
    }

    function pinDfnPanel(dfnPanel) {
        // Switch it to "activated" state, which pins it.
        dfnPanel.classList.add("activated");
        dfnPanel.style.left = null;
        dfnPanel.style.top = null;
    }

    function hideDfnPanel(dfnPanel, dfn) {
        if(!dfn) {
            dfn = document.getElementById(dfnPanel.getAttribute("data-for"));
        }
        dfn.setAttribute("aria-expanded", "false")
        dfnPanel.classList.remove("on");
        dfnPanel.classList.remove("activated");
    }

    function toggleDfnPanel(dfnPanel, dfn) {
        if(dfnPanel.classList.contains("on")) {
            hideDfnPanel(dfnPanel, dfn);
        } else {
            showDfnPanel(dfnPanel, dfn);
        }
    }

    function insertDfnPopupAction(dfn, dfnPanel) {
        // Find dfn panel
        const panelWrapper = document.createElement('span');
        panelWrapper.appendChild(dfnPanel);
        panelWrapper.style.position = "relative";
        panelWrapper.style.height = "0px";
        dfn.insertAdjacentElement("afterend", panelWrapper);
        dfn.setAttribute('role', 'button');
        dfn.setAttribute('aria-expanded', 'false')
        dfn.tabIndex = 0;
        dfn.classList.add('has-dfn-panel');
        dfn.addEventListener('click', (event) => {
            showDfnPanel(dfnPanel, dfn);
            event.stopPropagation();
        });
        dfn.addEventListener('keypress', (event) => {
            const kc = event.keyCode;
            // 32->Space, 13->Enter
            if(kc == 32 || kc == 13) {
                toggleDfnPanel(dfnPanel, dfn);
                event.stopPropagation();
                event.preventDefault();
            }
        });

        dfnPanel.addEventListener('click', (event) => {
            if (event.target.nodeName == 'A') {
                pinDfnPanel(dfnPanel);
            }
            event.stopPropagation();
        });

        dfnPanel.addEventListener('keydown', (event) => {
            if(event.keyCode == 27) { // Escape key
                hideDfnPanel(dfnPanel, dfn);
                event.stopPropagation();
                event.preventDefault();
            }
        })
    }
}
</script>
<script>/* Boilerplate: script-dfn-panel-json */
window.dfnpanelData = {};
window.dfnpanelData['resource-server'] = {"dfnID": "resource-server", "url": "#resource-server", "dfnText": "Resource Server", "refSections": [{"refs": [{"id": "ref-for-resource-server"}], "title": "Interoperability"}, {"refs": [{"id": "ref-for-resource-server\u2460"}], "title": "4.1. \n  Accept-Events\n"}, {"refs": [{"id": "ref-for-resource-server\u2461"}, {"id": "ref-for-resource-server\u2462"}, {"id": "ref-for-resource-server\u2463"}], "title": "4.2. \n  Events\n"}, {"refs": [{"id": "ref-for-resource-server\u2464"}, {"id": "ref-for-resource-server\u2465"}, {"id": "ref-for-resource-server\u2466"}], "title": "5.2. Methods"}, {"refs": [{"id": "ref-for-resource-server\u2467"}], "title": "5.3. Status Codes"}, {"refs": [{"id": "ref-for-resource-server\u2468"}], "title": "6. Discovery"}, {"refs": [{"id": "ref-for-resource-server\u2460\u24ea"}], "title": "6.1. Request"}, {"refs": [{"id": "ref-for-resource-server\u2460\u2460"}], "title": "6.2. Not Available"}, {"refs": [{"id": "ref-for-resource-server\u2460\u2461"}, {"id": "ref-for-resource-server\u2460\u2462"}, {"id": "ref-for-resource-server\u2460\u2463"}, {"id": "ref-for-resource-server\u2460\u2464"}], "title": "6.3. Available"}, {"refs": [{"id": "ref-for-resource-server\u2460\u2465"}, {"id": "ref-for-resource-server\u2460\u2466"}, {"id": "ref-for-resource-server\u2460\u2467"}, {"id": "ref-for-resource-server\u2460\u2468"}], "title": "7. Request"}, {"refs": [{"id": "ref-for-resource-server\u2461\u24ea"}, {"id": "ref-for-resource-server\u2461\u2460"}, {"id": "ref-for-resource-server\u2461\u2461"}, {"id": "ref-for-resource-server\u2461\u2462"}], "title": "8.1. Not Available"}, {"refs": [{"id": "ref-for-resource-server\u2461\u2463"}, {"id": "ref-for-resource-server\u2461\u2464"}], "title": "8.2. Error Response"}, {"refs": [{"id": "ref-for-resource-server\u2461\u2465"}, {"id": "ref-for-resource-server\u2461\u2466"}], "title": "8.3. Notification Errors"}, {"refs": [{"id": "ref-for-resource-server\u2461\u2467"}, {"id": "ref-for-resource-server\u2461\u2468"}], "title": "9.1. Common Headers"}, {"refs": [{"id": "ref-for-resource-server\u2462\u24ea"}], "title": "9.2. Only Notifications"}, {"refs": [{"id": "ref-for-resource-server\u2462\u2460"}], "title": "9.2.1. Headers"}, {"refs": [{"id": "ref-for-resource-server\u2462\u2461"}, {"id": "ref-for-resource-server\u2462\u2462"}], "title": "9.2.2. Body"}, {"refs": [{"id": "ref-for-resource-server\u2462\u2463"}], "title": "9.3. Composite Response"}, {"refs": [{"id": "ref-for-resource-server\u2462\u2464"}], "title": "9.3.1. Headers"}, {"refs": [{"id": "ref-for-resource-server\u2462\u2465"}], "title": "9.3.2. Body"}, {"refs": [{"id": "ref-for-resource-server\u2462\u2466"}, {"id": "ref-for-resource-server\u2462\u2467"}], "title": "9.4. Termination"}, {"refs": [{"id": "ref-for-resource-server\u2462\u2468"}], "title": "Generation"}, {"refs": [{"id": "ref-for-resource-server\u2463\u24ea"}, {"id": "ref-for-resource-server\u2463\u2460"}, {"id": "ref-for-resource-server\u2463\u2461"}], "title": "Headers"}, {"refs": [{"id": "ref-for-resource-server\u2463\u2462"}, {"id": "ref-for-resource-server\u2463\u2463"}], "title": "Body"}, {"refs": [{"id": "ref-for-resource-server\u2463\u2464"}, {"id": "ref-for-resource-server\u2463\u2465"}], "title": "Security Considerations"}, {"refs": [{"id": "ref-for-resource-server\u2463\u2466"}, {"id": "ref-for-resource-server\u2463\u2467"}, {"id": "ref-for-resource-server\u2463\u2468"}, {"id": "ref-for-resource-server\u2464\u24ea"}, {"id": "ref-for-resource-server\u2464\u2460"}, {"id": "ref-for-resource-server\u2464\u2461"}], "title": "Security and Privacy Review"}], "external": false};
window.dfnpanelData['application-client'] = {"dfnID": "application-client", "url": "#application-client", "dfnText": "Application Client", "refSections": [{"refs": [{"id": "ref-for-application-client"}], "title": "Interoperability"}, {"refs": [{"id": "ref-for-application-client\u2460"}], "title": "3. Terminology"}, {"refs": [{"id": "ref-for-application-client\u2461"}, {"id": "ref-for-application-client\u2462"}, {"id": "ref-for-application-client\u2463"}], "title": "4.1. \n  Accept-Events\n"}, {"refs": [{"id": "ref-for-application-client\u2464"}], "title": "5.2. Methods"}, {"refs": [{"id": "ref-for-application-client\u2465"}], "title": "6. Discovery"}, {"refs": [{"id": "ref-for-application-client\u2466"}], "title": "6.1. Request"}, {"refs": [{"id": "ref-for-application-client\u2467"}, {"id": "ref-for-application-client\u2468"}, {"id": "ref-for-application-client\u2460\u24ea"}], "title": "7. Request"}, {"refs": [{"id": "ref-for-application-client\u2460\u2460"}], "title": "8.3. Notification Errors"}, {"refs": [{"id": "ref-for-application-client\u2460\u2461"}], "title": "9.2. Only Notifications"}, {"refs": [{"id": "ref-for-application-client\u2460\u2462"}], "title": "9.2.2. Body"}, {"refs": [{"id": "ref-for-application-client\u2460\u2463"}], "title": "9.3. Composite Response"}, {"refs": [{"id": "ref-for-application-client\u2460\u2464"}], "title": "9.4. Termination"}, {"refs": [{"id": "ref-for-application-client\u2460\u2465"}], "title": "\n  Appendix A: Additional Semantics for `message/rfc822`\n"}, {"refs": [{"id": "ref-for-application-client\u2460\u2466"}], "title": "Request"}, {"refs": [{"id": "ref-for-application-client\u2460\u2467"}], "title": "Generation"}, {"refs": [{"id": "ref-for-application-client\u2460\u2468"}, {"id": "ref-for-application-client\u2461\u24ea"}], "title": "Body"}, {"refs": [{"id": "ref-for-application-client\u2461\u2460"}, {"id": "ref-for-application-client\u2461\u2461"}], "title": "Security Considerations"}, {"refs": [{"id": "ref-for-application-client\u2461\u2462"}], "title": "Security and Privacy Review"}], "external": false};
window.dfnpanelData['application-client—resource-server-interoperability'] = {"dfnID": "application-client\u2014resource-server-interoperability", "url": "#application-client\u2014resource-server-interoperability", "dfnText": "Application Client\u2014Resource Server Interoperability", "refSections": [{"refs": [{"id": "ref-for-application-client\u2014resource-server-interoperability"}], "title": "Interoperability"}], "external": false};
window.dfnpanelData['base-response'] = {"dfnID": "base-response", "url": "#base-response", "dfnText": "Base Response", "refSections": [{"refs": [{"id": "ref-for-base-response"}, {"id": "ref-for-base-response\u2460"}, {"id": "ref-for-base-response\u2461"}], "title": "7. Request"}, {"refs": [{"id": "ref-for-base-response\u2462"}, {"id": "ref-for-base-response\u2463"}], "title": "9.2. Only Notifications"}, {"refs": [{"id": "ref-for-base-response\u2464"}], "title": "9.3. Composite Response"}, {"refs": [{"id": "ref-for-base-response\u2465"}], "title": "9.3.2. Body"}], "external": false};
window.dfnpanelData['event-field'] = {"dfnID": "event-field", "url": "#event-field", "dfnText": "Event Field", "refSections": [{"refs": [{"id": "ref-for-event-field"}, {"id": "ref-for-event-field\u2460"}, {"id": "ref-for-event-field\u2461"}, {"id": "ref-for-event-field\u2462"}], "title": "5.1. Event Fields"}, {"refs": [{"id": "ref-for-event-field\u2463"}], "title": "6.3. Available"}, {"refs": [{"id": "ref-for-event-field\u2464"}, {"id": "ref-for-event-field\u2465"}, {"id": "ref-for-event-field\u2466"}], "title": "7. Request"}, {"refs": [{"id": "ref-for-event-field\u2467"}, {"id": "ref-for-event-field\u2468"}], "title": "8.2. Error Response"}, {"refs": [{"id": "ref-for-event-field\u2460\u24ea"}, {"id": "ref-for-event-field\u2460\u2460"}], "title": "8.3. Notification Errors"}, {"refs": [{"id": "ref-for-event-field\u2460\u2461"}, {"id": "ref-for-event-field\u2460\u2462"}], "title": "9.1. Common Headers"}, {"refs": [{"id": "ref-for-event-field\u2460\u2463"}], "title": "Request"}, {"refs": [{"id": "ref-for-event-field\u2460\u2464"}, {"id": "ref-for-event-field\u2460\u2465"}], "title": "Body"}], "external": false};
window.dfnpanelData['accept-events-header'] = {"dfnID": "accept-events-header", "url": "#accept-events-header", "dfnText": "4.1. \n  Accept-Events\n", "refSections": [{"refs": [{"id": "ref-for-accept-events-header"}], "title": "3. Terminology"}, {"refs": [{"id": "ref-for-accept-events-header"}, {"id": "ref-for-accept-events-header\u2460"}, {"id": "ref-for-accept-events-header\u2461"}, {"id": "ref-for-accept-events-header\u2462"}, {"id": "ref-for-accept-events-header\u2463"}, {"id": "ref-for-accept-events-header\u2464"}], "title": "4.1. \n  Accept-Events\n"}, {"refs": [{"id": "ref-for-accept-events-header\u2465"}, {"id": "ref-for-accept-events-header\u2466"}, {"id": "ref-for-accept-events-header\u2467"}, {"id": "ref-for-accept-events-header\u2468"}, {"id": "ref-for-accept-events-header\u2460\u24ea"}], "title": "4.1.1. Validity"}, {"refs": [{"id": "ref-for-accept-events-header\u2460\u2460"}], "title": "4.1.2. Syntax"}, {"refs": [{"id": "ref-for-accept-events-header\u2460\u2461"}, {"id": "ref-for-accept-events-header\u2460\u2462"}], "title": "4.2. \n  Events\n"}, {"refs": [{"id": "ref-for-accept-events-header\u2460\u2463"}], "title": "4.2.1. Validity"}, {"refs": [{"id": "ref-for-accept-events-header\u2460\u2464"}], "title": "5.1. Event Fields"}, {"refs": [{"id": "ref-for-accept-events-header\u2460\u2465"}, {"id": "ref-for-accept-events-header\u2460\u2466"}], "title": "5.2. Methods"}, {"refs": [{"id": "ref-for-accept-events-header\u2460\u2467"}], "title": "5.3. Status Codes"}, {"refs": [{"id": "ref-for-accept-events-header\u2460\u2468"}], "title": "6.2. Not Available"}, {"refs": [{"id": "ref-for-accept-events-header\u2461\u24ea"}], "title": "6.3. Available"}, {"refs": [{"id": "ref-for-accept-events-header\u2461\u2460"}, {"id": "ref-for-accept-events-header\u2461\u2461"}], "title": "7. Request"}, {"refs": [{"id": "ref-for-accept-events-header\u2461\u2462"}], "title": "8.1. Not Available"}, {"refs": [{"id": "ref-for-accept-events-header\u2461\u2463"}, {"id": "ref-for-accept-events-header\u2461\u2464"}], "title": "9.1. Common Headers"}, {"refs": [{"id": "ref-for-accept-events-header\u2461\u2465"}], "title": "Request"}], "external": false};
window.dfnpanelData['events-header'] = {"dfnID": "events-header", "url": "#events-header", "dfnText": "4.2. \n  Events\n", "refSections": [{"refs": [{"id": "ref-for-events-header"}], "title": "3. Terminology"}, {"refs": [{"id": "ref-for-events-header"}, {"id": "ref-for-events-header\u2460"}, {"id": "ref-for-events-header\u2461"}, {"id": "ref-for-events-header\u2462"}], "title": "4.2. \n  Events\n"}, {"refs": [{"id": "ref-for-events-header\u2463"}, {"id": "ref-for-events-header\u2464"}, {"id": "ref-for-events-header\u2465"}, {"id": "ref-for-events-header\u2466"}, {"id": "ref-for-events-header\u2467"}, {"id": "ref-for-events-header\u2468"}], "title": "4.2.1. Validity"}, {"refs": [{"id": "ref-for-events-header\u2460\u24ea"}], "title": "4.2.2. Syntax"}, {"refs": [{"id": "ref-for-events-header\u2460\u2460"}], "title": "5.1. Event Fields"}, {"refs": [{"id": "ref-for-events-header\u2460\u2461"}, {"id": "ref-for-events-header\u2460\u2462"}], "title": "5.2. Methods"}, {"refs": [{"id": "ref-for-events-header\u2460\u2463"}, {"id": "ref-for-events-header\u2460\u2464"}], "title": "5.3. Status Codes"}, {"refs": [{"id": "ref-for-events-header\u2460\u2465"}], "title": "8.1. Not Available"}, {"refs": [{"id": "ref-for-events-header\u2460\u2466"}], "title": "8.2. Error Response"}, {"refs": [{"id": "ref-for-events-header\u2460\u2467"}], "title": "8.3. Notification Errors"}, {"refs": [{"id": "ref-for-events-header\u2460\u2468"}], "title": "9.1. Common Headers"}], "external": false};
window.dfnpanelData['delta-representation'] = {"dfnID": "delta-representation", "url": "#delta-representation", "dfnText": "delta representation", "refSections": [{"refs": [{"id": "ref-for-delta-representation"}, {"id": "ref-for-delta-representation\u2460"}], "title": "Body"}], "external": false};
window.dfnpanelData['http-headerdef-delta'] = {"dfnID": "http-headerdef-delta", "url": "#http-headerdef-delta", "dfnText": "delta", "refSections": [{"refs": [{"id": "ref-for-http-headerdef-delta"}, {"id": "ref-for-http-headerdef-delta\u2460"}], "title": "Body"}], "external": false};
</script>
<script>/* Boilerplate: script-dom-helper */
function query(sel) { return document.querySelector(sel); }

function queryAll(sel) { return [...document.querySelectorAll(sel)]; }

function iter(obj) {
	if(!obj) return [];
	var it = obj[Symbol.iterator];
	if(it) return it;
	return Object.entries(obj);
}

function mk(tagname, attrs, ...children) {
	const el = document.createElement(tagname);
	for(const [k,v] of iter(attrs)) {
		if(k.slice(0,3) == "_on") {
			const eventName = k.slice(3);
			el.addEventListener(eventName, v);
		} else if(k[0] == "_") {
			// property, not attribute
			el[k.slice(1)] = v;
		} else {
			if(v === false || v == null) {
        continue;
      } else if(v === true) {
        el.setAttribute(k, "");
        continue;
      } else {
  			el.setAttribute(k, v);
      }
		}
	}
	append(el, children);
	return el;
}

/* Create shortcuts for every known HTML element */
[
  "a",
  "abbr",
  "acronym",
  "address",
  "applet",
  "area",
  "article",
  "aside",
  "audio",
  "b",
  "base",
  "basefont",
  "bdo",
  "big",
  "blockquote",
  "body",
  "br",
  "button",
  "canvas",
  "caption",
  "center",
  "cite",
  "code",
  "col",
  "colgroup",
  "datalist",
  "dd",
  "del",
  "details",
  "dfn",
  "dialog",
  "div",
  "dl",
  "dt",
  "em",
  "embed",
  "fieldset",
  "figcaption",
  "figure",
  "font",
  "footer",
  "form",
  "frame",
  "frameset",
  "head",
  "header",
  "h1",
  "h2",
  "h3",
  "h4",
  "h5",
  "h6",
  "hr",
  "html",
  "i",
  "iframe",
  "img",
  "input",
  "ins",
  "kbd",
  "label",
  "legend",
  "li",
  "link",
  "main",
  "map",
  "mark",
  "meta",
  "meter",
  "nav",
  "nobr",
  "noscript",
  "object",
  "ol",
  "optgroup",
  "option",
  "output",
  "p",
  "param",
  "pre",
  "progress",
  "q",
  "s",
  "samp",
  "script",
  "section",
  "select",
  "small",
  "source",
  "span",
  "strike",
  "strong",
  "style",
  "sub",
  "summary",
  "sup",
  "table",
  "tbody",
  "td",
  "template",
  "textarea",
  "tfoot",
  "th",
  "thead",
  "time",
  "title",
  "tr",
  "u",
  "ul",
  "var",
  "video",
  "wbr",
  "xmp",
].forEach(tagname=>{
	mk[tagname] = (...args) => mk(tagname, ...args);
});

function* nodesFromChildList(children) {
	for(const child of children.flat(Infinity)) {
		if(child instanceof Node) {
			yield child;
		} else {
			yield new Text(child);
		}
	}
}
function append(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		if(el instanceof Node) el.appendChild(child);
		else el.push(child);
	}
	return el;
}

function insertAfter(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		el.parentNode.insertBefore(child, el.nextSibling);
	}
	return el;
}

function clearContents(el) {
	el.innerHTML = "";
	return el;
}

function parseHTML(markup) {
	if(markup.toLowerCase().trim().indexOf('<!doctype') === 0) {
		const doc = document.implementation.createHTMLDocument("");
		doc.documentElement.innerHTML = markup;
		return doc;
	} else {
		const el = mk.template({});
		el.innerHTML = markup;
		return el.content;
	}
}
</script>